(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{232:function(e,t,n){e.exports=n(427)},427:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(39),c=n.n(o),i=n(431),u=n(97),s=n(13),l=n.n(s),d=n(17),h=n.n(d),m=n(40),g=n.n(m),p={},f=function(e){if(p[e])return p[e];var t=localStorage.getItem(e);if(t){var n=JSON.parse(t);return p[e]=n,n}return null},y=function(e,t){delete p[e];try{localStorage.setItem(e,JSON.stringify(t))}catch(n){}},b=n(19),v=n(7),E=n(93),M=n.n(E),O={excludeFirstMonth:{localStorageKey:"budget-reports-exclude-first-month",default:!1},excludeLastMonth:{localStorageKey:"budget-reports-exclude-last-month",default:!1},investmentAccounts:{localStorageKey:"budget-reports-investment-accounts",default:{}},lastUpdated:{localStorageKey:"budget-reports-last-updated",default:null},mortgageAccounts:{localStorageKey:"budget-reports-mortgage-accounts",default:{}},netWorthHiddenAccounts:{localStorageKey:"budget-reports-networth-hidden-accounts",default:{}},spendingMonthsToCompare:{localStorageKey:"budget-reports-spending-months-to-compare",default:3},trendsShowAverage:{localStorageKey:"budget-reports-trends-show-average",default:!0}},x=function(e,t){var n=O[e];if(!n)throw new Error("not a valid settings key");return M()(f(n.localStorageKey),t,n.default)},j=function(e,t,n){var a=O[e];if(!a)throw new Error("not a valid settings key");var r=f(a.localStorageKey);y(a.localStorageKey,Object(v.a)({},r,Object(b.a)({},t,n)))},C=n(9),S=n.n(C),I=n(75),k=n.n(I),A=n(209),w=n.n(A),B=n(74),_=n.n(B),T=n(48),P=n.n(T),F=n(210),R=n.n(F),G=n(16),L=n.n(G),D=n(76),Y=n.n(D),z=function(e){return function(t){var n={};return t.forEach(function(t){var a=e(t);n[a]||(n[a]=[]),n[a].push(t)}),n}},N=function(e){return function(t){var n={};return t.forEach(function(t){n[t[e]]||(n[t[e]]=[]),n[t[e]].push(t)}),n}},U=function(e){return function(t){return t.reduce(function(t,n){return Object(v.a)({},t,Object(b.a)({},n[e],n))},{})}},W=function(e){return function(t){return t.reduce(function(t,n){return t+n[e]},0)}},q=function(e){var t=null,n=null;return function(){for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return null!==t&&t.length===r.length&&r.every(function(e,n){return e===t[n]})?n:(t=r,n=e.apply(void 0,r))}},K=function(e){return function(t){return e.every(function(e){return!e(t)})}},H=u.b.convertMilliUnitsToCurrencyAmount,V=["Internal Master Category","Credit Card Payments"],J=function(e){var t=Y()(e.subtransactions.map(function(e){return e.transaction_id})),n=e.category_groups.filter(function(e){return!V.includes(e.name)}),a=e.categories.filter(function(e){return!e.deleted}).map(function(e){return Object(v.a)({},e,{activity:H(e.activity),balance:H(e.balance),budgeted:H(e.budgeted)})}),r=U("id")(a),o=l()().subtract(23,"months").format("YYYY-MM-01"),c={symbol:e.currency_format.currency_symbol};return Object(v.a)({},P()(["category_groups","currency_format"])(e),{accountsById:U("id")(e.accounts),categoryGroups:n,categoryGroupsById:U("id")(n),categories:a,categoriesById:r,currencyFormat:c,payeesById:U("id")(e.payees),months:L()("month")(e.months),transactions:S()([function(e){return e.map(function(e){return Object(v.a)({},e,{amount:H(e.amount)})})},function(e){return e.filter(function(e){return!e.category_id||!!r[e.category_id]})},k()(function(n){return t.includes(n.id)?S()([function(e){return e.map(function(e){return P()("transaction_id")(Object(v.a)({},n,e))})},function(e){return e.filter(_()("transaction_id",n.id))}])(e.subtransactions):n}),R.a,w()(function(e){return e.date<o}),L()("date"),function(e){return e.filter(function(e){return 0!==e.amount})}])(e.transactions)})},$=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=arguments.length>3?arguments[3]:void 0;return t.reduce(function(e,t){return function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e,t){return t},r=!1,o=e.map(function(e){return e[t]===n[t]?(r=!0,a(e,n)):e});return r?o:o.concat(n)}(e,n,t,a)},e)},Z=["accounts","categories","category_groups","payee_locations","payees","scheduled_subtransactions","scheduled_transactions","subtransactions","transactions"],Q=null,X=function(){return Q||(Q=f("ynab_budget_details"))},ee=function(e){var t=e.id,n=e.budget,a=e.server_knowledge,r=X(),o=Object(v.a)({},r,Object(b.a)({},t,{budget:n,server_knowledge:a}));y("ynab_budget_details",o),Q=o},te="https://api.youneedabudget.com/oauth/authorize?client_id=a956b3eb0134b7ba4a854eae1ef58fdaefa3b44109af6643d86e5e1479e5c608&redirect_uri=https://tomcheng.github.io/budget-reports/&response_type=token",ne=null,ae=function(){return ne.budgets.getBudgets().then(function(e){var t=e.data;return y("ynab_budgets",t),t}).catch(function(e){if(g()({id:"401",name:"unauthorized"})(e.error)||"Failed to fetch"===e.message)return localStorage.removeItem("ynab_access_token"),f("ynab_budgets")||{budgets:[]};throw e})},re=function(e){return ne.budgets.getBudgetById(e).then(function(t){var n=t.data,a=n.budget,r=n.server_knowledge;return ee({id:e,budget:a,server_knowledge:r}),j("lastUpdated",e,l()().valueOf()),{budget:J(a),authorized:!0}}).catch(function(e){if(g()({id:"401",name:"unauthorized"})(e.error)||"Failed to fetch"===e.message)return localStorage.removeItem("ynab_access_token"),{budget:{categories:[],transactions:[],payees:[]},authorized:!1};throw e})},oe=function(e){var t=function(e){return h()(e)(X())}(e);return t?l()().valueOf()-x("lastUpdated",e)<8e3?re(e):ne.budgets.getBudgetById(e,t.server_knowledge).then(function(n){var a=n.data,r=function(e,t){return Object(v.a)({},e,t,Z.reduce(function(n,a){return Object(v.a)({},n,Object(b.a)({},a,$(e[a],t[a])))},{}),{months:$(e.months,t.months,"month",function(e,t){return Object(v.a)({},e,t,{categories:$(e.categories,t.categories)})})})}(t.budget,a.budget);return ee({id:e,budget:r,server_knowledge:a.server_knowledge}),j("lastUpdated",e,l()().valueOf()),{budget:J(r),authorized:!0}}).catch(function(e){if(g()({id:"401",name:"unauthorized"})(e.error)||"Failed to fetch"===e.message)return{budget:J(t.budget),authorized:!1};throw e}):re(e)},ce=function(){localStorage.setItem("budget-reports-last-location",window.location.hash)},ie=n(2),ue=n(3),se=n(5),le=n(4),de=n(6),he=n(432),me=n(428),ge=n(57),pe=n.n(ge),fe=n(10),ye=n(11);function be(){var e=Object(fe.a)(["\n  font-size: 11px;\n  line-height: 16px;\n  font-weight: 400;\n  color: #999;\n"]);return be=function(){return e},e}function ve(){var e=Object(fe.a)(["\n  font-size: 13px;\n  line-height: 21px;\n  font-weight: 400;\n  color: #666;\n"]);return ve=function(){return e},e}function Ee(){var e=Object(fe.a)(["\n  font-size: 14px;\n  line-height: 22px;\n  font-weight: 500;\n  color: #222;\n"]);return Ee=function(){return e},e}function Me(){var e=Object(fe.a)(["\n  font-weight: 500;\n  font-size: 16px;\n  line-height: 24px;\n  color: #222;\n"]);return Me=function(){return e},e}function Oe(){var e=Object(fe.a)(["\n  font-weight: 500;\n  font-size: 16px;\n  line-height: 24px;\n  color: #222;\n"]);return Oe=function(){return e},e}var xe=ye.a.div(Oe()),je=ye.a.div(Me()),Ce=ye.a.div(Ee()),Se=ye.a.div(ve()),Ie=ye.a.div(be()),ke=function(){return r.a.createElement("div",{style:{height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},r.a.createElement(Ce,null,"Loading\u2026"),r.a.createElement(Se,null,"beep, beep, boop"))},Ae=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.budgetId,n=e.budgetLoaded,a=e.onRequestBudget;n||a(t)}},{key:"render",value:function(){return this.props.budgetLoaded?this.props.children:r.a.createElement(ke,null)}}]),t}(a.Component),we=n(51),Be=n.n(we),_e=Be()("#4399ff").lighten(32).desaturate().toHexString(),Te=Be()("#4399ff").lighten(5).desaturate().toHexString(),Pe=Be()("#4399ff").lighten(25).desaturate().toHexString(),Fe=Be()("red").lighten(30).desaturate(60).toHexString();function Re(){var e=Object(fe.a)(["\n  background-color: ",";\n  border-color: ",";\n  color: #fff;\n"]);return Re=function(){return e},e}function Ge(){var e=Object(fe.a)(["\n  display: inline-block;\n  user-select: none;\n  border: 1px solid #ccc;\n  padding: 4px 12px;\n  border-radius: 2px;\n\n  & + & {\n    margin-left: 5px;\n  }\n"]);return Ge=function(){return e},e}var Le=Object(ye.a)(Se)(Ge()),De=Object(ye.a)(Le)(Re(),"#4399ff","#4399ff"),Ye=Le,ze=n(213),Ne=n(59),Ue=n(47),We=n.n(Ue),qe=n(77),Ke=n(130),He=n(131),Ve=n(132),Je=n(133),$e=n(134),Ze=n(135),Qe=n(136),Xe=n(137),et=n(138),tt=n(139),nt=n(215);qe.b.add(Ke.faArrowLeft,He.faBars,Ve.faCaretDown,Je.faChevronRight,$e.faCog,Ze.faEllipsisV,Qe.faEye,Xe.faEyeSlash,et.faPencilAlt,tt.faTimes);var at={"arrow-left":Ke.faArrowLeft,bars:He.faBars,"caret-down":Ve.faCaretDown,"chevron-right":Je.faChevronRight,cog:$e.faCog,pencil:et.faPencilAlt,"ellipsis-v":Ze.faEllipsisV,eye:Qe.faEye,"eye-slash":Xe.faEyeSlash,times:tt.faTimes},rt={faded:{fontWeight:400,color:"#aaa",fontSize:10}},ot=function(e){var t=e.icon,n=e.style,a=e.faded,o=Object(Ne.a)(e,["icon","style","faded"]);return r.a.createElement(nt.a,Object.assign({},o,{icon:at[t],style:Object(v.a)({},n,a&&rt.faded)}))},ct=n(430),it=n(390),ut=n(208),st=n(58),lt=n.n(st),dt=n(49),ht=n.n(dt),mt=n(15),gt=n.n(mt),pt=gt.a.convert({cap:!1}),ft=q(function(e){var t=h()("id")(e.payees.find(function(e){return"Starting Balance"===e.name})),n=h()("id")(e.payees.find(function(e){return"Reconciliation Balance Adjustment"===e.name}));return function(e){return e.payee_id===t||e.payee_id===n}}),yt=q(function(e){var t=h()("id")(e.categories.find(function(e){return"To be Budgeted"===e.name}));return function(e){return e.category_id===t}}),bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return!t.category_id||!!e[t.transfer_account_id]}},vt=function(e){return e.date.slice(0,7)},Et=function(e){return e.transactions.length?vt(e.transactions[e.transactions.length-1]):void 0},Mt=function(e){var t=e.payeesById,n=e.transactions,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return S()([pt(function(e,n){return Object(v.a)({},t[n]?ht()(["id","name"])(t[n]):{id:"no-payee",name:"(no payee)"},{amount:W("amount")(e)/a})}),N("payee_id")])(n)},Ot=function(e){return e.replace(/[^a-zA-Z0-9 ]/g,"").trim()},xt=n(34);function jt(){var e=Object(fe.a)(["\n  padding: 0 20px 15px;\n"]);return jt=function(){return e},e}function Ct(){var e=Object(fe.a)(["\n  padding: 0 10px;\n  margin-right: -10px;\n  align-self: stretch;\n  display: flex;\n  align-items: center;\n"]);return Ct=function(){return e},e}function St(){var e=Object(fe.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 15px 20px;\n  user-select: none;\n"]);return St=function(){return e},e}function It(){var e=Object(fe.a)(["\n  margin: 2px;\n  background-color: #fff;\n  border: 1px solid #e5e5e5;\n  border-radius: 2px;\n"]);return It=function(){return e},e}var kt=ye.a.div(It()),At=Object(ye.a)(Ce)(St()),wt=ye.a.div(Ct()),Bt=ye.a.div(jt()),_t=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={expanded:!0},n.handleClickTitle=function(){n.setState(function(e){return Object(v.a)({},e,{expanded:!e.expanded})})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.actions,n=e.children,a=e.hasSettings,o=e.noPadding,c=e.title,i=e.onClickSettings,u=this.state.expanded;return r.a.createElement(kt,null,r.a.createElement(At,null,r.a.createElement("div",{style:{display:"flex",alignItems:"center"},onClick:this.handleClickTitle},c,r.a.createElement(ot,{icon:"chevron-right",transform:{rotate:u?90:0},style:{marginLeft:10},faded:!0})),a&&u&&r.a.createElement(wt,{onClick:i},r.a.createElement(ot,{icon:"cog",faded:!0})),u&&t),r.a.createElement(xt.a,{isExpanded:u},r.a.createElement(Bt,{style:{padding:o&&0}},n)))}}]),t}(a.Component),Tt=n(230),Pt=n(94),Ft=n.n(Pt),Rt=n(216),Gt=n.n(Rt),Lt=n(37),Dt=n.n(Lt),Yt=n(20),zt=n.n(Yt),Nt=n(217),Ut=n.n(Nt),Wt=n(218),qt=n.n(Wt),Kt={chart:{height:240,spacing:[0,0,0,0]},credits:{enabled:!1},legend:{enabled:!1},title:{text:""},subtitle:{text:""},tooltip:{enabled:!1},xAxis:{tickLength:0}},Ht=function(e){var t=e.options;return r.a.createElement(qt.a,{highcharts:Ut.a,options:Object(v.a)({},Kt,t,{chart:Object(v.a)({},Kt.chart,t.chart),xAxis:Object(v.a)({},Kt.xAxis,t.xAxis)})})},Vt=r.a.createContext(),Jt=function(e){var t=e.amount,n=e.amountAfterDecimal,a=e.positiveIsRed,o=e.showCurrencySymbol,c=e.style;return r.a.createElement(Vt.Consumer,null,function(e){return r.a.createElement("span",{style:Object(v.a)({},c,{color:t>0&&(a?"red":"#2cbc2f")})},t>0&&(a?"-":"+"),o&&(h()("symbol")(e)||"$"),function(e){for(var t=(e+="").split("."),n=t[0],a=t.length>1?"."+t[1]:"",r=/(\d+)(\d{3})/;r.test(n);)n=n.replace(r,"$1,$2");return n+a}(Math.abs(t).toFixed(n)))})};Jt.defaultProps={amountAfterDecimal:2};var $t=Jt,Zt=function(e){var t=e.numbers,n=e.alwaysRound,a=t.some(function(e){var t=e.amount;return Math.abs(t)<100});return r.a.createElement("div",{style:{textAlign:"right",lineHeight:"16px",display:"flex",justifyContent:"flex-start",flexDirection:"row-reverse",marginBottom:8}},t.map(function(e){var t=e.amount,o=e.label,c=e.isMoney,i=void 0===c||c,u=e.decimalsToRound;return r.a.createElement("div",{key:o,style:{marginLeft:20}},r.a.createElement(je,{style:{lineHeight:"16px"}},r.a.createElement($t,{amount:t,amountAfterDecimal:Ft()(u)?u:a&&!n?2:0,showCurrencySymbol:i,positiveIsRed:!0})),r.a.createElement(Ie,null,o))}))};function Qt(){var e=Object(fe.a)(["\n  border-top: 1px solid #ddd;\n  display: flex;\n  justify-content: space-between;\n"]);return Qt=function(){return e},e}var Xt=ye.a.div(Qt()),en=function(e){var t=e.month,n=e.transactionsByDate,a=l()().format("YYYY-MM-DD"),r=0;return Dt()(-1,l()(t).daysInMonth()).map(function(e){var o=-1===e?l()(t).add(-1,"days"):"".concat(t,"-").concat(Gt()("0")(2)(e+1));return o>a?null:r+=-zt()("amount")(n[o]||[])})},tn=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.total,n=e.transactions,o=e.highlightFunction,c=e.currentMonth,i=e.monthsToCompare,u=o?n.filter(o):[],s={type:"areaspline",data:en({month:c,transactionsByDate:N("date")(u)}),enableMouseTracking:!1,marker:{enabled:!1},animation:!1,color:"#4399ff",lineWidth:0,fillOpacity:.8},d=l()(c).daysInMonth(),h=l()(c).add(-1,"days"),m=l()(c).add(d-1,"days"),g=N("date")(n),p=en({month:c,transactionsByDate:g}),f=Dt()(0,d+1).map(function(e){return e/d*t}),y=parseInt(h.format("d"),10),b=Dt()(0,6).map(function(e){return{color:"#f2f2f2",from:7*e-1.5-y,to:7*e+.5-y}}),E=Dt()(i,0).map(function(e){return{type:"spline",data:en({month:l()(c).subtract(e,"months").format("YYYY-MM"),transactionsByDate:g}),enableMouseTracking:!1,color:"#"+Be.a.mix("#4399ff","#f2f2f2",30+70*(e-1)/i).toHex(),lineWidth:1,marker:{enabled:!1},animation:!1}}),M=S()([W("amount"),lt()(function(e){return vt(e)===c})])(n),O=[{amount:M,label:"spent"}];return Ft()(t)&&O.push({amount:-(t+M),label:"available"}),r.a.createElement(a.Fragment,null,r.a.createElement(Zt,{numbers:O}),r.a.createElement(Ht,{key:i,options:{chart:{spacing:[0,0,0,0],height:140,animation:!1},xAxis:{labels:{enabled:!1},plotBands:b},yAxis:{visible:!1,endOnTick:!1,startOnTick:!1},series:[{type:"line",color:"#aaa",dashStyle:"Dot",lineWidth:1,data:f,enableMouseTracking:!1,marker:{enabled:!1},animation:!1}].concat(Object(Tt.a)(E),[Object(v.a)({type:"spline",data:p,enableMouseTracking:!1,color:"#4399ff",marker:{enabled:!1},animation:!1},o&&{type:"areaspline",fillOpacity:.2}),s])}}),r.a.createElement(Xt,null,r.a.createElement(Ie,null,h.format("MMM D")),r.a.createElement(Ie,null,m.format("MMM D"))))}}]),t}(a.PureComponent);function nn(){var e=Object(fe.a)(["\n  position: relative;\n  min-width: 200px;\n  padding: 15px 20px;\n  margin-left: 20px;\n  margin-right: 20px;\n  background-color: #fff;\n  border-radius: 2px;\n  transition: transform 0.2s ease-in-out, opacity 0.2s ease-in-out;\n"]);return nn=function(){return e},e}function an(){var e=Object(fe.a)(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: rgba(0, 0, 0, 0.7);\n  opacity: 0;\n  transition: opacity 0.2s ease-in-out;\n"]);return an=function(){return e},e}function rn(){var e=Object(fe.a)(["\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n"]);return rn=function(){return e},e}var on=ye.a.div(rn()),cn=ye.a.div(an()),un=ye.a.div(nn()),sn=function(e){return requestAnimationFrame(function(){requestAnimationFrame(e)})},ln=function(e){function t(){var e;return Object(ie.a)(this,t),(e=Object(se.a)(this,Object(le.a)(t).call(this))).handleTransitionEnd=function(){var t=e.state.animationState;"entering"===t?e.setState({animationState:"entered"}):"leaving"===t&&e.setState({animationState:"left"})},e.el=document.createElement("div"),e.state={animationState:"left"},e}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"componentDidMount",value:function(){document.body.appendChild(this.el)}},{key:"componentDidUpdate",value:function(e){var t=this;!e.open&&this.props.open&&sn(function(){t.setState({animationState:"entering"})}),e.open&&!this.props.open&&sn(function(){t.setState({animationState:"leaving"})})}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.el)}},{key:"render",value:function(){var e=this.props,t=e.open,n=e.children,a=e.title,c=e.onClose,i=e.width,u=this.state.animationState;if(!t&&"left"===u)return null;var s=["entering","entered"].includes(u);return Object(o.createPortal)(r.a.createElement(on,null,r.a.createElement(cn,{onClick:c,style:{opacity:s?1:0},onTransitionEnd:this.handleTransitionEnd}),r.a.createElement(un,{style:{opacity:s?1:0,transform:"translate3d(0, ".concat(s?"0":"20px",", 0)"),width:i}},a&&r.a.createElement(Ce,{style:{marginBottom:10}},a),n,r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:20}},r.a.createElement(De,{onClick:c},"Done")))),this.el)}}]),t}(a.Component),dn=function(e){var t=e.open,n=e.monthsToCompare,a=e.onClose,o=e.onDecrementMonths,c=e.onIncrementMonths;return r.a.createElement(ln,{open:t,title:"Chart Settings",onClose:a},r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement("div",{style:{marginRight:10}},r.a.createElement(Ye,{onClick:o},"-"),r.a.createElement(Ye,{onClick:c},"+")),r.a.createElement(Se,null,"Compare with the last ",n," month",1===n?"":"s")))},hn=12,mn=function(e){function t(e){var n;return Object(ie.a)(this,t),(n=Object(se.a)(this,Object(le.a)(t).call(this))).handleClickSettings=function(){n.setState({modalOpen:!0})},n.handleCloseModal=function(){n.setState({modalOpen:!1})},n.handleDecrementMonths=function(){n.setState(function(e){return Object(v.a)({},e,{monthsToCompare:Math.max(e.monthsToCompare-1,0)})},n.saveSetting)},n.handleIncrementMonths=function(){n.setState(function(e){return Object(v.a)({},e,{monthsToCompare:Math.min(e.monthsToCompare+1,hn)})},n.saveSetting)},n.saveSetting=function(){j("spendingMonthsToCompare",n.props.budgetId,n.state.monthsToCompare)},n.state={modalOpen:!1,monthsToCompare:x("spendingMonthsToCompare",e.budgetId)},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.transactions,n=e.budgetId,o=e.currentMonth,c=e.highlightFunction,i=e.title,u=e.total,s=this.state,l=s.modalOpen,d=s.monthsToCompare;return r.a.createElement(a.Fragment,null,r.a.createElement(_t,{title:i,hasSettings:!0,onClickSettings:this.handleClickSettings},r.a.createElement(tn,{budgetId:n,currentMonth:o,highlightFunction:c,monthsToCompare:d,total:u,transactions:t})),r.a.createElement(dn,{open:l,monthsToCompare:d,onClose:this.handleCloseModal,onDecrementMonths:this.handleDecrementMonths,onIncrementMonths:this.handleIncrementMonths}))}}]),t}(a.Component);mn.defaultProps={title:"Day by Day"};var gn=mn;function pn(){var e=Object(fe.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 0;\n  border-top: 1px dotted #ddd;\n  user-select: none;\n\n  &:first-child {\n    border-top: ",";\n    padding-top: ",";\n  }\n"]);return pn=function(){return e},e}var fn=ye.a.div(pn(),function(e){return!e.isContinuing&&0},function(e){return!e.isContinuing&&0});function yn(){var e=Object(fe.a)(["\n  text-align: center;\n  margin: 10px;\n  opacity: 0.5;\n"]);return yn=function(){return e},e}var bn=Object(ye.a)(Se)(yn()),vn=function(){return r.a.createElement(bn,null,"No transactions this month")},En=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.minorText,a=e.inLink,o=e.to,c=e.bold;return r.a.createElement(Se,{style:{fontWeight:c&&700,display:"flex",alignItems:"baseline",whiteSpace:"pre",overflow:"hidden",color:a&&"inherit"}},o?r.a.createElement(it.a,{to:o},t):t,n&&r.a.createElement(Ie,{style:{fontWeight:c&&700,overflow:"hidden",textOverflow:"ellipsis"}},"\xa0\u2013 ",n))}}]),t}(a.PureComponent),Mn=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.count,a=e.inLink,o=e.selected,c=e.showCount,i=e.to;return r.a.createElement(En,{bold:o,label:t,minorText:c&&"".concat(n," transaction").concat(1===n?"":"s"),inLink:a,to:i})}}]),t}(a.PureComponent);Mn.defaultProps={showCount:!0};var On=Mn,xn=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.amount,n=e.positiveIsRed,a=e.total,o=e.faded,c=e.selected;return r.a.createElement(Se,{style:{display:"flex",alignItems:"baseline",opacity:o?.3:1,fontWeight:c&&700}},r.a.createElement($t,{amount:t,positiveIsRed:n}),r.a.createElement(Ie,{style:{width:44,textAlign:"right",fontWeight:c&&700}},a?"".concat((t/a*100).toFixed(1),"%"):"\u2013"))}}]),t}(a.PureComponent),jn=function(e){var t=e.count,n=e.pluralizedName,a=e.showAll,o=e.onToggle;return r.a.createElement(Ie,{style:{textAlign:"center",marginTop:5},onClick:o},a?"see less":"see all ".concat(t," ").concat(n))},Cn=gt.a.convert({cap:!1}),Sn={category_group_id:"category groups",category_id:"categories",payee_id:"payees"},In=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={showAll:!1,allMounted:!1},n.handleToggleShowAll=function(){var e=n.state,t=e.allMounted,a=e.showAll;t?n.setState({showAll:!a}):(n.setState({allMounted:!0}),requestAnimationFrame(function(){n.setState({showAll:!0})}))},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.emptyName,n=e.entityKey,o=e.entityFunction,c=e.entitiesById,i=e.positiveIsRed,u=e.linkFunction,s=e.limitShowing,l=e.numMonths,d=e.selectedEntityId,m=e.showAverage,g=e.showAverageToggle,p=e.showTransactionCount,f=e.title,y=e.transactions,b=e.onClickEntity,v=e.onToggleAverage,E=this.state,M=E.allMounted,O=E.showAll,x=0,j=S()([L()("amount"),Cn(function(e,t){var n=W("amount")(e);return x+=n,{entityId:t,transactions:e.length,amount:n}}),o?z(o):N(n)])(y),C=s&&j.length>6,I=j.slice(0,5),k=j.slice(5);return r.a.createElement(_t,{title:f,actions:g&&r.a.createElement(Se,{onClick:v},m?"average":"total")},0===j.length&&r.a.createElement(vn,null),(C?I:j).map(function(e){var n=e.entityId,a=e.transactions,o=e.amount;return r.a.createElement(An,{key:n,showTransactionCount:p,to:u&&c[n]?u(n):null,transactions:a,name:h()("name")(c[n])||t,amount:m?o/l:o,positiveIsRed:i,selected:n===d,total:m?x/l:x,id:n,onClick:b})}),M&&r.a.createElement(xt.a,{isExpanded:O},r.a.createElement(a.Fragment,null,k.map(function(e){var n=e.entityId,a=e.transactions,o=e.amount;return r.a.createElement(An,{key:n,showTransactionCount:p,to:u&&c[n]?u(n):null,transactions:a,name:h()("name")(c[n])||t,amount:m?o/l:o,positiveIsRed:i,selected:n===d,total:x,id:n,onClick:b,isContinuing:!0})}))),!!k.length&&C&&r.a.createElement(jn,{count:j.length,pluralizedName:Sn[n],showAll:O,onToggle:this.handleToggleShowAll}))}}]),t}(a.Component);In.defaultProps={emptyName:"(none)"};var kn=function(e){var t=e.to,n=e.children,a=Object(Ne.a)(e,["to","children"]);return t?r.a.createElement(it.a,Object.assign({},a,{to:t}),n):r.a.createElement("span",a,n)},An=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.showTransactionCount,n=e.to,a=e.transactions,o=e.name,c=e.amount,i=e.positiveIsRed,u=e.total,s=e.selected,l=e.id,d=e.onClick,h=e.isContinuing;return r.a.createElement(fn,{isContinuing:h,onClick:d&&function(){return d(l)}},t?r.a.createElement(On,{count:a,label:o,selected:s,to:n}):r.a.createElement(kn,{to:n,onClick:n&&function(e){e.stopPropagation()}},r.a.createElement(Se,{style:{whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",color:"inherit",fontWeight:s&&700}},o)),r.a.createElement(xn,{amount:c,positiveIsRed:i,selected:s,total:u}))}}]),t}(a.PureComponent),wn=In,Bn=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={selectedGroupId:null},n.handleSelectGroup=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedGroupId:t.selectedGroupId===e?null:e})})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.currentMonth,o=e.investmentAccounts,c=this.state.selectedGroupId,i=t.categoryGroupsById,u=t.categoriesById,s=t.id,l=c&&i[c],d=t.transactions.filter(K([yt(t),bt(o),ft(t)])),h=lt()(function(e){return vt(e)===n})(d);return r.a.createElement(a.Fragment,null,r.a.createElement(gn,{budgetId:t.id,currentMonth:n,transactions:d,highlightFunction:c&&function(e){return u[e.category_id].category_group_id===c},title:l?"Day by Day: ".concat(Ot(l.name)):"Day by Day"}),r.a.createElement(wn,{entitiesById:i,entityFunction:function(e){return u[e.category_id].category_group_id},linkFunction:function(e){return ro(oo.currentMonthGroup.path,{budgetId:s,categoryGroupId:e})},selectedEntityId:c,title:"Category Groups",transactions:h,showTransactionCount:!0,onClickEntity:this.handleSelectGroup}))}}]),t}(a.PureComponent),_n=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.category,n=e.payee,a=e.memo,o=e.date,c=e.amount,i=e.isContinuing;return r.a.createElement(fn,{isContinuing:i},r.a.createElement("div",{style:{overflow:"hidden"}},r.a.createElement(En,{label:h()("name")(n)||"(no payee)",minorText:(h()("name")(t)||"")+(a?" (".concat(a,")"):"")}),r.a.createElement(Ie,null,l()(o).format("dddd, MMM D"))),r.a.createElement(Se,null,r.a.createElement($t,{amount:c})))}}]),t}(a.PureComponent),Tn=function(e){var t=e.transactions,n=e.title,a=e.categoriesById,o=e.payeesById;return r.a.createElement(_t,{title:n},t.length?t.map(function(e){var t=e.id,n=e.category_id,c=e.payee_id,i=e.date,u=e.memo,s=e.amount;return r.a.createElement(_n,{key:t,amount:s,category:a[n],date:i,memo:u,payee:o[c]})}):r.a.createElement(vn,null))};Tn.defaultProps={title:"Transactions"};var Pn=Tn,Fn=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={selectedCategoryId:null},n.handleSelectCategory=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedCategoryId:t.selectedCategoryId===e?null:e})})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.categoryGroupId,o=e.currentMonth,c=this.state.selectedCategoryId,i=t.id,u=t.payeesById,s=t.categories,l=t.categoriesById,d=t.transactions,h=c&&l[c],m=s.filter(function(e){return e.category_group_id===n}),g=m.map(function(e){return e.id}),p=d.filter(function(e){return g.includes(e.category_id)}),f=p.filter(function(e){return vt(e)===o}),y=c&&f.filter(function(e){return e.category_id===c}),b=-W("activity")(m),v=W("balance")(m);return r.a.createElement(a.Fragment,null,r.a.createElement(gn,{budgetId:i,currentMonth:o,highlightFunction:c&&function(e){return e.category_id===c},title:h?"Day by Day: ".concat(Ot(h.name)):"Day by Day",transactions:p,total:b+v}),r.a.createElement(wn,{entityKey:"category_id",entitiesById:l,linkFunction:function(e){return ro(oo.currentMonthCategory.path,{budgetId:i,categoryGroupId:n,categoryId:e})},selectedEntityId:c,title:"Categories",transactions:f,showTransactionCount:!0,onClickEntity:this.handleSelectCategory}),r.a.createElement(Pn,{categoriesById:l,payeesById:u,transactions:y||f,title:h?"Transactions: ".concat(Ot(h.name)):"Transactions"}))}}]),t}(a.PureComponent),Rn=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.currentMonth,o=e.categoryId,c=t.id,i=t.payeesById,u=t.categoriesById,s=t.transactions,l=u[o],d=s.filter(function(e){return e.category_id===o}),h=d.filter(function(e){return vt(e)===n}),m=-l.activity,g=l.balance;return r.a.createElement(a.Fragment,null,r.a.createElement(gn,{key:l?l.name:"day-by-day",budgetId:c,currentMonth:n,title:"Day by Day",transactions:d,total:m+g}),r.a.createElement(Pn,{categoriesById:u,payeesById:i,transactions:h}))}}]),t}(a.PureComponent),Gn=n(95),Ln=n.n(Gn),Dn=function(e){var t=e.average,n=e.data,a=e.height,o=e.series,c=e.selectedMonth,i=e.stacked,u=e.onSelectMonth,s=[],d=[],h=n.map(function(e){return l()(e.month).format("MMM")}),m=null;return c&&(m={months:[c],color:_e}),n.forEach(function(e,t){var n=e.month;"Jan"===l()(n).format("MMM")&&s.push({color:"#ccc",width:1,value:t-.5,zIndex:3})}),m&&m.months.forEach(function(e){var t=Ln()(function(t){return t.month===e})(n);d.push({color:m.color,from:t-.5,to:t+.5})}),r.a.createElement(Ht,{key:n.length,options:{chart:{animation:!1,height:a,type:"column",events:{click:function(e){u&&u(n[Math.round(e.xAxis[0].value)].month)}}},xAxis:{categories:h,plotBands:d,plotLines:s},yAxis:{endOnTick:!1,startOnTick:!1,gridLineColor:"transparent",labels:{enabled:!1},title:{text:null},plotLines:t&&[{color:"#aaa",dashStyle:"Dot",width:1,value:-t,zIndex:2}]},plotOptions:{series:{animation:!1,stacking:i?"normal":null}},series:o.map(function(e){return"line"===e.type?{color:e.color,data:n.map(e.valueFunction),enableMouseTracking:!1,type:"line"}:{borderWidth:0,color:e.color,data:n.map(e.valueFunction),enableMouseTracking:!1,states:{hover:{brightness:0}}}})}})};Dn.defaultProps={height:140,stacked:!0};var Yn=Dn;function zn(){var e=Object(fe.a)(["\n  box-sizing: border-box;\n  height: ","px;\n  width: ","px;\n  border-radius: 50%;\n  background-color: #fff;\n  transform: translate3d(","px, 0, 0);\n  transition: transform 0.15s ease-in-out;\n"]);return zn=function(){return e},e}function Nn(){var e=Object(fe.a)(["\n  box-sizing: border-box;\n  padding: ","px;\n  display: inline-block;\n  width: ","px;\n  height: ","px;\n  border-radius: ","px;\n  background-color: ",";\n  transition: background-color 0.15s ease-in-out;\n"]);return Nn=function(){return e},e}var Un=ye.a.div(Nn(),2,32,18,9,function(e){return e.on?"#4399ff":"#ddd"}),Wn=ye.a.div(zn(),14,14,function(e){return e.on?14:0}),qn=function(e){var t=e.on,n=e.onClick;return r.a.createElement(Un,{on:t,onClick:n},r.a.createElement(Wn,{on:t}))};function Kn(){var e=Object(fe.a)([""]);return Kn=function(){return e},e}function Hn(){var e=Object(fe.a)(["\n  user-select: none;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin: 10px 0;\n"]);return Hn=function(){return e},e}var Vn=ye.a.div(Hn()),Jn=ye.a.div(Kn()),$n=function(e){var t=e.label,n=e.name,a=e.checked,o=e.onChange;return r.a.createElement(Vn,{onClick:function(){o({target:{name:n,checked:!a}})}},r.a.createElement(Jn,null,t),r.a.createElement(qn,{on:a,onClick:function(){o({target:{name:n,checked:!a}})}}))},Zn=function(e){var t=e.excludeFirstMonth,n=e.excludeLastMonth,a=e.open,o=e.onClose,c=e.onSetExclusion;return r.a.createElement(ln,{open:a,onClose:o,title:"Chart Settings",width:240},r.a.createElement($n,{checked:t,label:"Exclude first month",name:"excludeFirstMonth",onChange:function(){c({month:"first",exclude:!t})}}),r.a.createElement($n,{checked:n,label:"Exclude last month",name:"excludeLastMonth",onChange:function(){c({month:"last",exclude:!n})}}),r.a.createElement(Ie,{style:{marginTop:5}},"Excluding incomplete months may lead to more representative averages"))},Qn=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={settingsModalOpen:!1},n.handleClickSettings=function(){n.setState({settingsModalOpen:!0})},n.handleCloseModal=function(){n.setState({settingsModalOpen:!1})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.excludeFirstMonth,n=e.excludeLastMonth,a=e.highlightFunction,o=e.months,c=e.selectedMonth,i=e.title,u=e.transactions,s=e.onSelectMonth,d=e.onSetExclusion,h=this.state.settingsModalOpen,m=0,g=0,p=z(vt)(u),f=o.map(function(e){var t=z(a||function(){return!1})(p[e]||[]),n=W("amount")(t.false||[]),r=W("amount")(t.true||[]);return m+=a?r:n,e===c&&(g=a?r:n),{month:e,amount:-n,highlighted:-r}}),y=c?[{amount:m/o.length,label:"average"},{amount:g,label:l()(c).format("MMM YYYY")}]:[{amount:m/o.length,label:"average"},{amount:m,label:"total"}],b=[{color:a?Pe:Te,valueFunction:function(e){return e.amount}}];return a&&b.push({color:Te,valueFunction:function(e){return e.highlighted}}),r.a.createElement(_t,{title:i,hasSettings:!0,onClickSettings:this.handleClickSettings},r.a.createElement(Zt,{numbers:y}),r.a.createElement(Yn,{data:f,average:m/o.length,series:b,selectedMonth:c,onSelectMonth:s}),r.a.createElement(Zn,{excludeFirstMonth:t,excludeLastMonth:n,open:h,onClose:this.handleCloseModal,onSetExclusion:d}))}}]),t}(a.Component);Qn.defaultProps={title:"Month by Month"};var Xn=Qn,ea=function(e){function t(e){var n;return Object(ie.a)(this,t),(n=Object(se.a)(this,Object(le.a)(t).call(this))).handleToggleGroupAverage=function(){n.setState(function(e){return Object(v.a)({},e,{showAverage:!e.showAverage})},function(){j("trendsShowAverage",n.props.budget.id,n.state.showAverage)})},n.state={showAverage:x("trendsShowAverage",e.budget.id)},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.excludeFirstMonth,o=e.excludeLastMonth,c=e.months,i=e.transactions,u=e.selectedMonth,s=e.selectedGroupId,d=e.onSelectGroup,h=e.onSelectMonth,m=e.onSetExclusion,g=this.state.showAverage,p=t.categoryGroupsById,f=t.categoriesById,y=t.id,b=s&&p[s],v=u&&i.filter(function(e){return vt(e)===u});return r.a.createElement(a.Fragment,null,r.a.createElement(Xn,{excludeFirstMonth:n,excludeLastMonth:o,highlightFunction:s&&function(e){return f[e.category_id].category_group_id===s},months:c,selectedMonth:u,title:b?"Month by Month: ".concat(Ot(b.name)):"Month by Month",transactions:i,onSelectMonth:h,onSetExclusion:m}),r.a.createElement(wn,{key:u||"all",entityFunction:function(e){return f[e.category_id].category_group_id},entityKey:"category_group_id",entitiesById:p,linkFunction:function(e){return ro(oo.group.path,{budgetId:y,categoryGroupId:e})},selectedEntityId:s,title:u?"Category Groups: ".concat(l()(u).format("MMMM")):"Category Groups",transactions:v||i,onClickEntity:d,numMonths:c.length,showAverageToggle:!u,showAverage:g&&!u,onToggleAverage:this.handleToggleGroupAverage,limitShowing:!0}))}}]),t}(a.PureComponent),ta=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={allMounted:!1,showAll:!1},n.handleToggleShowAll=function(){var e=n.state,t=e.allMounted,a=e.showAll;t?n.setState({showAll:!a}):(n.setState({allMounted:!0}),requestAnimationFrame(function(){n.setState({showAll:!0})}))},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.categoriesById,n=e.payeesById,o=e.selectedCategoryId,c=e.selectedPayeeId,i=e.selectedMonth,u=e.transactions,s=e.limitShowing,d=this.state,h=d.allMounted,m=d.showAll,g=o&&t[o],p=c&&n[c],f=l()(i).format("MMMM"),y=S()([s?L()("amount"):function(e){return e.reverse()},function(e){return e.filter(function(e){return vt(e)===i&&(!o||e.category_id===o)&&(!c||e.payee_id===c)})}])(u),b=s&&y.length>5,v=b?y.slice(0,3):y,E=b?y.slice(3):[];return r.a.createElement(_t,{title:p?"Transactions: ".concat(f,", ").concat(p.name):g?"Transactions: ".concat(f,", ").concat(g.name):"Transactions: ".concat(f)},v.length?v.map(function(e){var a=e.id,o=e.date,c=e.amount,i=e.memo,u=e.payee_id,s=e.category_id;return r.a.createElement(_n,{key:a,amount:c,category:t[s],date:o,memo:i,payee:n[u]})}):r.a.createElement(vn,null),h&&r.a.createElement(xt.a,{isExpanded:m},r.a.createElement(a.Fragment,null,E.map(function(e){var a=e.id,o=e.date,c=e.amount,i=e.payee_id,u=e.category_id;return r.a.createElement(_n,{key:a,amount:c,category:t[u],date:o,payee:n[i],isContinuing:!0})}))),!!E.length&&r.a.createElement(jn,{count:y.length,pluralizedName:"transactions",showAll:m,onToggle:this.handleToggleShowAll}))}}]),t}(a.Component);ta.defaultProps={limitShowing:!0};var na=ta,aa=function(e){function t(e){var n;return Object(ie.a)(this,t),(n=Object(se.a)(this,Object(le.a)(t).call(this))).handleToggleAverage=function(){n.setState(function(e){return Object(v.a)({},e,{showAverage:!e.showAverage})},function(){j("trendsShowAverage",n.props.budget.id,n.state.showAverage)})},n.state={showAverage:x("trendsShowAverage",e.budget.id)},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.categoryGroup,o=e.excludeFirstMonth,c=e.excludeLastMonth,i=e.months,u=e.selectedMonth,s=e.selectedCategoryId,d=e.transactions,h=e.onSelectMonth,m=e.onSelectCategory,g=e.onSetExclusion,p=this.state.showAverage,f=t.categories,y=t.categoriesById,b=t.payeesById,v=t.id,E=s&&y[s],M=f.filter(function(e){return e.category_group_id===n.id}).map(function(e){return e.id}),O=d.filter(function(e){return M.includes(e.category_id)}),x=u&&S()([L()("amount"),function(e){return e.filter(function(e){return vt(e)===u})}])(O);return r.a.createElement(a.Fragment,null,r.a.createElement(Xn,{excludeFirstMonth:o,excludeLastMonth:c,months:i,highlightFunction:s&&function(e){return e.category_id===s},selectedMonth:u,title:E?"Month by Month: ".concat(Ot(E.name)):"Month by Month",transactions:O,onSelectMonth:h,onSetExclusion:g}),r.a.createElement(wn,{key:"categories-".concat(u||"all"),entityKey:"category_id",entitiesById:y,linkFunction:function(e){return ro(oo.category.path,{budgetId:v,categoryGroupId:n.id,categoryId:e})},title:u?"Categories: ".concat(l()(u).format("MMMM")):"Categories",transactions:x||O,selectedEntityId:s,onClickEntity:m,showAverageToggle:!u,showAverage:p&&!u,numMonths:i.length,onToggleAverage:this.handleToggleAverage,limitShowing:!0}),u&&x.length>0&&r.a.createElement(na,{key:"transactions-".concat(u||"all","-").concat(s||"all"),categoriesById:y,payeesById:b,selectedMonth:u,selectedCategoryId:s,transactions:x}))}}]),t}(a.PureComponent),ra=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.category,n=e.budget,o=e.excludeFirstMonth,c=e.excludeLastMonth,i=e.months,u=e.selectedMonth,s=e.selectedPayeeId,d=e.transactions,h=e.onSelectMonth,m=e.onSelectPayee,g=e.onSetExclusion,p=n.categoriesById,f=n.payeesById,y=n.id,b=s&&f[s],v=d.filter(function(e){return e.category_id===t.id}),E=u&&v.filter(function(e){return vt(e)===u});return r.a.createElement(a.Fragment,null,r.a.createElement(Xn,{excludeFirstMonth:o,excludeLastMonth:c,months:i,onSetExclusion:g,highlightFunction:s&&function(e){return e.payee_id===s},selectedMonth:u,title:b?"Month by Month: ".concat(Ot(b.name)):"Month by Month",transactions:v,onSelectMonth:h}),r.a.createElement(wn,{key:"payees-".concat(u||"all"),emptyName:"(no payee)",entitiesById:f,entityKey:"payee_id",linkFunction:function(e){return ro(oo.categoryPayee.path,{budgetId:y,categoryGroupId:t.category_group_id,categoryId:t.id,payeeId:e})},title:u?"Payees: ".concat(l()(u).format("MMMM")):"Payees",transactions:E||v,selectedEntityId:s,onClickEntity:m,limitShowing:!0}),u&&E.length>0&&r.a.createElement(na,{key:"transactions-".concat(u||"all","-").concat(s||"all"),categoriesById:p,payeesById:f,transactions:E,selectedMonth:u,selectedPayeeId:s}))}}]),t}(a.PureComponent),oa=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).handleSelectMonth=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedMonth:t.selectedMonth===e?null:e})})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.category,o=e.excludeFirstMonth,c=e.excludeLastMonth,i=e.months,u=e.payee,s=e.selectedMonth,l=e.transactions,d=e.onSelectMonth,h=e.onSetExclusion,m=t.categoriesById,g=t.payeesById,p=l.filter(function(e){return e.category_id===n.id&&e.payee_id===u.id});return r.a.createElement(a.Fragment,null,r.a.createElement(Xn,{excludeFirstMonth:o,excludeLastMonth:c,months:i,selectedMonth:s,transactions:p,onSelectMonth:d,onSetExclusion:h}),s&&r.a.createElement(na,{categoriesById:m,payeesById:g,selectedMonth:s,transactions:p,limitShowing:!1}))}}]),t}(a.PureComponent),ca=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={selectedMonth:null,selectedPayeeId:null},n.handleSelectMonth=function(e){n.setState(function(t){return{selectedMonth:e===t.selectedMonth?null:e}})},n.handleSelectPayee=function(e){n.setState(function(t){return{selectedPayeeId:e===t.selectedPayeeId?null:e}})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.excludeFirstMonth,o=e.excludeLastMonth,c=e.months,i=e.transactions,u=e.onSetExclusion,s=this.state,d=s.selectedMonth,h=s.selectedPayeeId,m=t.payeesById,g=d&&i.filter(function(e){return vt(e)===d});return r.a.createElement(a.Fragment,null,r.a.createElement(Xn,{excludeFirstMonth:n,excludeLastMonth:o,highlightFunction:h&&function(e){return e.payee_id===h},months:c,selectedMonth:d,title:h?"Month by Month: ".concat(Ot(m[h].name)):"Month by Month",transactions:i,onSelectMonth:this.handleSelectMonth,onSetExclusion:u}),r.a.createElement(wn,{key:"payee-".concat(d||"all"),entityKey:"payee_id",entitiesById:m,title:d?"Payees: ".concat(l()(d).format("MMMM")):"Payees",transactions:g||i,selectedEntityId:h,onClickEntity:this.handleSelectPayee,showAverageToggle:!1,showAverage:!d,numMonths:c.length,limitShowing:!0}))}}]),t}(a.PureComponent),ia=n(60),ua=n.n(ia),sa=function(e){var t=e.data,n=e.onSelectMonth,a=e.selectedMonth;return r.a.createElement(Yn,{data:t,height:160,selectedMonth:a,series:[{color:Pe,valueFunction:function(e){return e.income}},{color:Fe,valueFunction:function(e){return e.expenses}},{type:"line",color:"#4399ff",valueFunction:function(e){return e.income+e.expenses}}],onSelectMonth:n})},la=n(61),da=n.n(la);function ha(){var e=Object(fe.a)(["\n  box-sizing: border-box;\n  padding-left: 3px;\n  width: ","px;\n  font-weight: 400;\n  color: #888;\n  font-size: 10px;\n"]);return ha=function(){return e},e}function ma(){var e=Object(fe.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 0;\n  user-select: none;\n\n  ",":first-child > & {\n    padding-top: 0;\n  }\n"]);return ma=function(){return e},e}var ga=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={expanded:!1,childrenMounted:!1},n.handleToggleExpand=function(){var e=n.state,t=e.expanded;e.childrenMounted?n.setState({expanded:!t}):(n.setState({childrenMounted:!0}),requestAnimationFrame(function(){n.setState({expanded:!0})}))},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.id,a=e.amount,o=e.nodes,c=e.isTopLevel,i=e.valueRenderer,u=this.state,s=u.expanded,l=u.childrenMounted,d=!!o&&o.length>0;return r.a.createElement(Ea,{hasChildNodes:d,isTopLevel:c},d?r.a.createElement(ba,{id:n,name:t,amount:a,expanded:s,onToggle:this.handleToggleExpand,valueRenderer:i}):r.a.createElement(va,{id:n,name:t,amount:a,valueRenderer:i}),d&&l&&r.a.createElement(xt.a,{isExpanded:s},r.a.createElement(pa,{nodes:o,valueRenderer:i})))}}]),t}(a.Component),pa=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.nodes,n=e.valueRenderer;return r.a.createElement("div",{style:{paddingLeft:18}},t.map(function(e){return r.a.createElement(ga,Object.assign({},e,{key:e.id,isTopLevel:!1,valueRenderer:n}))}))}}]),t}(a.PureComponent),fa=ye.a.div(ma(),fn),ya=ye.a.div(ha(),18),ba=function(e){var t=e.expanded,n=e.name,a=e.id,o=e.amount,c=e.valueRenderer,i=e.onToggle;return r.a.createElement(fa,{onClick:i},r.a.createElement(Se,{style:{whiteSpace:"pre",display:"flex",alignItems:"center"}},r.a.createElement(ya,null,r.a.createElement(ot,{icon:"chevron-right",transform:{rotate:t?90:0}})),"function"===typeof n?n({expanded:t}):n),c?c({amount:o,id:a,faded:t}):r.a.createElement(Se,{style:{opacity:t?.3:1}},r.a.createElement($t,{amount:o})))},va=function(e){var t=e.name,n=e.id,a=e.amount,o=e.valueRenderer;return r.a.createElement(fa,null,r.a.createElement(Se,null,t),o?o({amount:a,id:n}):r.a.createElement(Se,null,r.a.createElement($t,{amount:a})))},Ea=function(e){var t=e.isTopLevel,n=(e.hasChildNodes,e.children);return t?r.a.createElement(fn,{style:{display:"block",padding:0}},n):n},Ma=ga,Oa=function(e){var t=e.nodes,n=e.valueRenderer;return t.map(function(e){var t=e.id,a=e.name,o=e.amount,c=e.nodes;return r.a.createElement(Ma,{key:t,id:t,name:a,amount:o,nodes:c,valueRenderer:n,isTopLevel:!0})})};Oa.defaultProps={reverse:!1};var xa=Oa,ja=gt.a.convert({cap:!1}),Ca=function(e){var t=e.categoriesById,n=e.categoryGroupsById,a=e.transactions,o=e.totalIncome,c=e.payeesById,i=e.divideBy,u=S()([ja(function(e,n){var a=Mt({payeesById:c,transactions:e},i);return Object(v.a)({},ht()(["id","name","category_group_id"])(t[n]),{nodes:L()("amount")(a),amount:W("amount")(a)})}),N("category_id")])(a),s=S()([ja(function(e,t){var a=ja(P()("category_group_id"))(e);return Object(v.a)({},ht()(["id","name"])(n[t]),{nodes:L()("amount")(a),amount:W("amount")(a)})}),N("category_group_id")])(u),l=Mt({payeesById:c,transactions:a.filter(function(e){return!e.category_id})},i),d=S()([function(e){return da()(e)([{id:"net",amount:-o-W("amount")(e),name:"Net Income"}])},L()("amount"),da()(l)])(s);return r.a.createElement(_t,{title:"Expenses Breakdown"},r.a.createElement(xa,{nodes:d,valueRenderer:function(e){return r.a.createElement(xn,Object.assign({},e,{positiveIsRed:!0,total:-o}))}}))};Ca.defaultProps={divideBy:1};var Sa=Ca,Ia=function(e){var t=e.transactions,n=e.payeesById,a=e.divideBy,o=Mt({payeesById:n,transactions:t},a),c=zt()("amount")(o);return r.a.createElement(_t,{title:"Income Breakdown"},r.a.createElement(xa,{nodes:L()("amount")(o).reverse(),total:c,valueRenderer:function(e){return r.a.createElement(xn,Object.assign({},e,{total:c}))}}))};Ia.defaultProps={divideBy:1};var ka=Ia,Aa=function(e){var t=e.categoriesById,n=e.categoryGroupsById,o=e.payeesById,c=e.expenseTransactions,i=e.incomeTransactions,u=e.divideBy;return r.a.createElement(a.Fragment,null,r.a.createElement(Sa,{categoriesById:t,categoryGroupsById:n,payeesById:o,transactions:c,totalIncome:W("amount")(i)/u,divideBy:u}),r.a.createElement(ka,{payeesById:o,transactions:i,divideBy:u}))},wa=gt.a.convert({cap:!1}),Ba=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={selectedMonth:null,settingsModalOpen:!1},n.handleClickSettings=function(){n.setState({settingsModalOpen:!0})},n.handleCloseSettingsModal=function(){n.setState({settingsModalOpen:!1})},n.handleSelectMonth=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedMonth:t.selectedMonth===e?null:e})})},n.getSummaries=q(function(e,t,n){return S()([L()("month"),wa(function(e,t){var a=z(yt(n))(e);return{month:t,expenseTransactions:a.false||[],incomeTransactions:a.true||[],income:W("amount")(a.true||[]),expenses:W("amount")(a.false||[])}}),z(vt)])(e)}),n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.excludeFirstMonth,o=e.excludeLastMonth,c=e.investmentAccounts,i=e.showing,u=e.transactions,s=e.onSetExclusion,l=this.state,d=l.selectedMonth,h=l.settingsModalOpen,m=t.categoriesById,g=t.categoryGroupsById,p=t.payeesById,f="total"===i,y=this.getSummaries(u,c,t),b=d?[ua()(_()("month",d))(y)]:y,v=k()(function(e){return e.incomeTransactions})(b),E=k()(function(e){return e.expenseTransactions})(b),M=W("amount")(E),O=W("amount")(v),x=f?1:b.length;return r.a.createElement(a.Fragment,null,r.a.createElement(_t,{title:"Monthly Trend",hasSettings:!0,onClickSettings:this.handleClickSettings},r.a.createElement(Zt,{numbers:[{label:"net income",amount:-(M+O)/x},{label:"expenses",amount:M/x},{label:"income",amount:-O/x}]}),r.a.createElement(sa,{data:y,selectedMonth:d,onSelectMonth:this.handleSelectMonth}),r.a.createElement(Zn,{excludeFirstMonth:n,excludeLastMonth:o,open:h,onClose:this.handleCloseSettingsModal,onSetExclusion:s})),r.a.createElement(Aa,{categoriesById:m,categoryGroupsById:g,payeesById:p,expenseTransactions:E,incomeTransactions:v,divideBy:f?1:b.length}))}}]),t}(a.PureComponent),_a=n(219),Ta=n.n(_a),Pa=n(220),Fa=n.n(Pa),Ra=n(23),Ga=n.n(Ra),La=n(50),Da=n.n(La),Ya=n(62),za=n.n(Ya),Na=n(52),Ua=n.n(Na),Wa=n(140),qa=n.n(Wa),Ka=n(221),Ha=n.n(Ka),Va=n(141),Ja=n.n(Va),$a=n(30),Za=n.n($a),Qa=n(31),Xa=n.n(Qa),er=["mortgage","creditCard"],tr=function(e){var t=e.data,n=e.months,a=e.mortgageAccounts,o=e.selectedMonth,c=e.onSelectMonth,i=z(function(e){return function(e){var t=e.type,n=e.id;return e.mortgageAccounts[n]?"liability":Xa()(t)(er)?"liability":"asset"}({type:e.type,id:e.id,mortgageAccounts:a})})(t),u=n.map(function(e,t){return{month:e,assets:zt()(function(e){return e.data[t]})(i.asset),liabilities:zt()(function(e){return e.data[t]})(i.liability)}});return r.a.createElement(Yn,{selectedMonth:o,onSelectMonth:c,data:u,height:160,series:[{color:Fe,valueFunction:function(e){return Math.max(-e.liabilities,0)}},{color:Pe,valueFunction:function(e){return Math.max(e.assets,0)}},{color:"#4399ff",type:"line",valueFunction:function(e){return e.assets+e.liabilities}}],stacked:!1})},nr=n(222),ar=n.n(nr),rr=n(223),or=n.n(rr),cr=n(35),ir=n.n(cr),ur=n(224),sr=n.n(ur),lr=gt.a.convert({cap:!1}),dr=function(e){var t=e.accounts,n=e.investmentAccounts,a=e.mortgageAccounts,r=Da()(function(e){return n[e.id]?"Investments":a[e.id]?"Mortgages":sr()(e.type)})(t);return S()([function(e){return e.reverse()},L()("amount"),lr(function(e,t){return{name:t,accounts:e,amount:zt()("balance")(e),id:t,nodes:S()([L()("balance"),lr(function(e){var t=e.id,n=e.name;return{amount:e.balance,id:t,name:n}})])(e)}})])(r)},hr=function(e){var t=e.accountsById,n=e.hiddenAccounts,a=e.nodes,o=e.onToggleAccounts;return r.a.createElement(xa,{nodes:a,valueRenderer:function(e){var c=e.id,i=e.amount,u=a.find(or()("id",c)),s=u?u.accounts:[t[c]];return r.a.createElement(Se,{style:{display:"flex",alignItems:"center"}},r.a.createElement($t,{amount:i}),r.a.createElement("div",{style:{width:36,textAlign:"center"},onClick:function(e){e.stopPropagation(),o({ids:lr("id")(s)})}},ar()(function(e){return n[e.id]})(s)?r.a.createElement(ot,{icon:"eye-slash"}):r.a.createElement(ot,{icon:"eye"})))}})},mr=function(e){var t=e.accounts,n=e.hiddenAccounts,o=e.onToggleAccounts,c=e.investmentAccounts,i=e.mortgageAccounts,u=pe()("id")(t),s=dr({accounts:ir()(function(e){return n[e.id]})(t),investmentAccounts:c,mortgageAccounts:i}),l=dr({accounts:Ga()(function(e){return n[e.id]})(t),investmentAccounts:c,mortgageAccounts:i});return r.a.createElement(a.Fragment,null,r.a.createElement(_t,{title:"Accounts"},r.a.createElement(hr,{accountsById:u,hiddenAccounts:n,nodes:s,onToggleAccounts:o})),Za()(l).length>0&&r.a.createElement(_t,{title:"Hidden Accounts"},r.a.createElement(hr,{accountsById:u,hiddenAccounts:n,nodes:l,onToggleAccounts:o})))},gr=function(e){return e.reduce(function(e,t){return 0===e.length?[t]:e.concat(Ua()(e)+t)},[])},pr=function(e){function t(e){var n;return Object(ie.a)(this,t),(n=Object(se.a)(this,Object(le.a)(t).call(this))).groupByMonthAndAccount=q(S()([qa()(Da()("account_id")),Da()(function(e){return e.date.slice(0,7)})])),n.getMonths=q(function(e){return S()([L()(za.a),We.a,n.groupByMonthAndAccount])(e.transactions)}),n.getSummaryByAccount=q(function(e){var t=n.groupByMonthAndAccount(e.transactions),a=n.getMonths(e);return gt()(function(e){var n=e.id;return{id:n,data:S()([gr,gt()(function(e){return zt()("amount")(t[e][n])})])(a)}})(e.accounts)}),n.getSelectedBalances=q(function(e,t){var a=n.getMonths(t),r=Ln()(Fa()(e))(a),o=n.getSummaryByAccount(t);return S()([qa()(function(e){var t=e.data;return r>-1?t[r]:Ua()(t)}),pe()("id")])(o)}),n.handleSelectMonth=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedMonth:t.selectedMonth===e?null:e})})},n.handleToggleAccounts=function(e){var t=e.ids,a=n.props.budget,r=n.state.hiddenAccounts,o=t.some(function(e){return!r[e]}),c=t.reduce(function(e,t){return Object(v.a)({},e,Object(b.a)({},t,o))},r);n.setState({hiddenAccounts:c}),j("netWorthHiddenAccounts",a.id,c)},n.state={hiddenAccounts:x("netWorthHiddenAccounts",e.budget.id),selectedMonth:null},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budget,n=e.investmentAccounts,o=e.mortgageAccounts,c=this.state,i=c.hiddenAccounts,u=c.selectedMonth,s=this.getMonths(t),l=this.getSummaryByAccount(t),d=this.getSelectedBalances(u,t),h=Ha()(function(e,t){return i[t]}),m=S()([Ja.a,Ga()(function(e){return e<0}),Za.a,h])(d),g=S()([Ja.a,Ga()(function(e){return e>0}),Za.a,h])(d);return r.a.createElement(a.Fragment,null,r.a.createElement(_t,{title:"Monthly Trend"},r.a.createElement(Zt,{numbers:[{amount:-(g+m),label:"Net Worth"},{amount:-g,label:"Assets"},{amount:m,label:"Liabilities"}],alwaysRound:!0}),r.a.createElement(tr,{data:gt()(function(e){var n=e.id,a=e.data;return{data:i[n]?a.map(Ta()(0)):a,type:t.accountsById[n].type,id:n}})(l),months:s,mortgageAccounts:o,selectedMonth:u,onSelectMonth:this.handleSelectMonth})),r.a.createElement(mr,{accounts:gt()(function(e){return Object(v.a)({},e,{balance:d[e.id]})})(t.accounts),hiddenAccounts:i,investmentAccounts:n,mortgageAccounts:o,onToggleAccounts:this.handleToggleAccounts}))}}]),t}(a.PureComponent),fr=function(e){function t(e){var n;return Object(ie.a)(this,t),(n=Object(se.a)(this,Object(le.a)(t).call(this))).handleSetExclusion=function(e){var t=e.month,a=e.exclude,r="first"===t?"excludeFirstMonth":"excludeLastMonth";n.setState(Object(b.a)({},r,a),function(){j(r,n.props.budget.id,n.state[r])})},n.state={excludeFirstMonth:x("excludeFirstMonth",e.budget.id),excludeLastMonth:x("excludeLastMonth",e.budget.id)},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props.budget,t=this.state,n=t.excludeFirstMonth,a=t.excludeLastMonth,r=Et(e),o=function(e,t){for(var n=[e],a=e;a!==t;)a=l()(a).add(1,"months").format("YYYY-MM"),n.push(a);return n}(n?l()(r).add(1,"months").format("YYYY-MM"):r,a?l()().subtract(1,"months").format("YYYY-MM"):l()().format("YYYY-MM"));return this.props.children(Object(v.a)({},this.state,{months:o,onSetExclusion:this.handleSetExclusion}))}}]),t}(a.Component),yr=function(e){return function(t){return!!e[t.account_id]&&!!t.transfer_account_id&&!e[t.transfer_account_id]}},br=function(e,t){return function(n){return!!e[n.account_id]&&!n.transfer_account_id&&"Starting Balance"!==h()([n.payee_id,"name"])(t)}},vr=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={selectedMonth:null,selectedBreakdown:null},n.handleSelectMonth=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedMonth:t.selectedMonth===e?null:e})})},n.handleClickBreakdown=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedBreakdown:t.selectedBreakdown===e?null:e})})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.budget,o=t.investmentAccounts,c=this.state,i=c.selectedMonth,u=c.selectedBreakdown,s=n.payeesById;if(0===We()(o).length)return r.a.createElement(bn,null,"You don't have any accounts marked as investment accounts."," ",r.a.createElement(it.a,{to:ro(oo.settings.path,{budgetId:n.id})},"Go to Settings"));var l=n.transactions.filter(function(e,t){return function(n){return yr(e)(n)||br(e,t)(n)}}(o,s)).map(function(e){return Object(v.a)({},e,{amount:-e.amount})}),d=i&&l.filter(function(e){return vt(e)===i});return r.a.createElement(a.Fragment,null,r.a.createElement(fr,{budget:n},function(t){var n=t.excludeFirstMonth,a=t.excludeLastMonth,c=t.months,d=t.onSetExclusion;return r.a.createElement(Xn,{excludeFirstMonth:n,excludeLastMonth:a,highlightFunction:u&&function(e){return"contribution"===u?yr(o)(e):br(o,s)(e)},months:c,selectedMonth:i,transactions:l,onSelectMonth:e.handleSelectMonth,onSetExclusion:d})}),r.a.createElement(wn,{transactions:d||l,entitiesById:{contribution:{name:"Contributions"},capitalGain:{name:"Capital Gains/Losses"}},title:"Growth Breakdown",onClickEntity:this.handleClickBreakdown,selectedEntityId:u,entityFunction:function(e){return yr(o)(e)?"contribution":"capitalGain"},positiveIsRed:!0}))}}]),t}(a.PureComponent),Er=n(142),Mr=n.n(Er),Or=n(63),xr=n.n(Or),jr=n(225),Cr=n.n(jr),Sr=n(226),Ir=n.n(Sr),kr=n(65),Ar=n.n(kr),wr=n(227),Br=n.n(wr),_r=n(228),Tr=n.n(_r),Pr=function(e){var t=e.investmentsProjection,n=e.mortgageProjection,a=e.amountNeededToRetire,o=e.yearsUntilRetirement;return r.a.createElement(Ht,{options:{chart:{type:"column"},xAxis:{type:"category",plotBands:[{color:_e,from:Math.floor(o)-.5,to:Math.floor(o)+.5}]},yAxis:{title:{text:null},endOnTick:!1,plotLines:[{value:a,color:"#ccc",width:1}]},legend:{enabled:!1},series:[{data:t,color:"#4399ff",borderWidth:0},{data:n,color:"red",borderWidth:0}]}})},Fr=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},Rr=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).parent=null,n.handleBodyClick=function(e){n.props.onClickOff&&!Fr(n.parent,e.target)&&n.props.onClickOff()},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"componentDidMount",value:function(){document.body.addEventListener("click",this.handleBodyClick)}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("click",this.handleBodyClick)}},{key:"render",value:function(){var e=this;return this.props.children({ref:function(t){e.parent=t}})}}]),t}(a.Component);function Gr(){var e=Object(fe.a)(["\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: #fff;\n"]);return Gr=function(){return e},e}var Lr=document.getElementsByTagName("body")[0],Dr=ye.a.div(Gr()),Yr=function(e){var t=e.name,n=e.formatter,a=e.label,c=e.value,i=e.onBlur,u=e.onChange,s=e.onReset,l=e.rangeOptions;return Object(o.createPortal)(r.a.createElement(Rr,{onClickOff:t&&i},function(e){var o=e.ref;return r.a.createElement(Dr,{innerRef:o},r.a.createElement(xt.a,{isExpanded:!!t},r.a.createElement("div",{style:{borderTop:"1px solid #bbb",padding:"15px 20px"}},r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:15}},a,": ",n(c||0),r.a.createElement(Ye,{onClick:function(){s(t)}},"reset")),r.a.createElement(zr,Object.assign({},l,{name:t,value:c||0,onChange:u})))))}),Lr)};Yr.defaultProps={formatter:function(e){return e}};var zr=function(e){var t=e.name,n=(e.onReset,Object(Ne.a)(e,["name","onReset"]));return r.a.createElement("input",Object.assign({},n,{name:t,type:"range",style:{display:"block",width:"100%"}}))},Nr=Yr,Ur=[{label:"Average monthly contribution",name:"averageContribution",formatter:function(e){return"$".concat(Math.round(e))}},{label:"Average return on investments",name:"returnOnInvestments",formatter:function(e){return"".concat((100*e).toFixed(1),"%")}},{label:"Average expenses without mortgage",name:"averageExpenses",formatter:function(e){return"$".concat(Math.round(e))}},{label:"Return on investment after retirement",name:"retirementReturns",formatter:function(e){return"".concat((100*e).toFixed(1),"%")}},{label:"Average tax rate after retirement",name:"retirementTaxRate",formatter:function(e){return"".concat((100*e).toFixed(1),"%")}}],Wr=U("name")(Ur),qr=q(function(e,t,n){var a=function(e,t){var n=e.accounts,a=e.transactions,r=ua()(function(e){return t[e.id]})(n);if(!r)return null;var o=S()([L()("date"),Ga()(g()({account_id:r.id}))])(a),c=S()([function(e){return e.date.slice(0,7)},Ua.a])(o),i=Tr()(function(e){return e.date.slice(0,7)===c})(o),u=-S()([zt()("amount"),lt()(function(e){return e.date.slice(0,7)!==c})])(o),s=u-zt()("amount")(i),l=S()([Ar()("amount"),ua()(Ar()("transfer_account_id"))])(i),d=(s+l)/u-1,h=-Math.log(1-d*u/l)/Math.log(1+d),m=12*d,p=h-1,f=gt()(function(e){return Math.pow(1+d,e)*u-(Math.pow(1+d,e)-1)/d*l})(Dt()(1,h));return{rate:m,mortgagePayment:l,paymentsLeft:p,principalProjection:f}}(e,n)||{},r=a.paymentsLeft,o=a.mortgagePayment,c=a.principalProjection,i=function(e,t){var n=e.accounts,a=(e.payees,e.transactions),r=S()([Ga()(function(e){return t[e]}),gt()("id")])(n),o=S()([Da()(function(e){return e.date.slice(0,7)}),ir()(function(e){return Xa()(e.transfer_account_id)(r)}),Ga()(function(e){return Xa()(e.account_id)(r)})])(a),c=0,i=[],u=S()([L()(za.a),We.a])(o);gt()(function(e){return o[e]})(u).forEach(function(e){var t=S()([zt()("amount"),Ga()(Ar()("transfer_account_id"))])(e),n=ir()(Ar()("transfer_account_id"))(e),a=zt()("amount")(n);c&&n.length&&i.push(a/(c+.5*t)),c+=a+t});var s=S()([Br()(Ir.a,1),gt()(Cr()(1))])(i),l=i.length;return Math.pow(s,12/l)-1}(e,t),u=function(e,t){var n=e.accounts,a=e.transactions,r=S()([Ga()(function(e){return t[e]}),gt()("id")])(n),o=S()([Ga()(function(e){var t=e.transfer_account_id;return t&&!Xa()(t)(r)}),Ga()(function(e){var t=e.account_id;return Xa()(t)(r)})])(a),c=S()([L()(za.a),Y.a,gt()(function(e){return e.slice(0,7)}),gt()("date")])(o);return zt()("amount")(o)/(l()(Ua()(c)).diff(l()(xr()(c)),"months")+1)}(e,t),s=function(e,t){var n=e.accounts,a=e.transactions,r=S()([Ga()(function(e){return t[e]}),gt()("id")])(n);return S()([zt()("amount"),Ga()(function(e){var t=e.account_id;return Xa()(t)(r)})])(a)}(e,t),d=function(e,t,n){var a=e.transactions,r=e.accounts,o=e.payees,c=e.categoriesById,i=e.categoryGroupsById,u=S()([Ar()("id"),ua()(g()({name:"Starting Balance"}))])(o),s=S()([L()(za.a),Y.a,gt()(vt)])(a),l=S()([Ga()(function(e){return n[e]}),gt()("id")])(r),d=S()([Ga()(function(e){return t[e]}),gt()("id")])(r);return-S()([zt()("amount"),ir()(function(e){return e.amount>0&&!e.transfer_account_id&&(!e.category_id||!i[c[e.category_id].category_group_id])}),ir()(function(e){return Xa()(e.transfer_account_id)(da()(l,d))}),ir()(function(e){return Xa()(e.account_id)(da()(l,d))}),ir()(function(e){return Xa()(vt(e))([xr()(s),Ua()(s)])}),ir()(g()({payee_id:u}))])(a)/(s.length-2)}(e,t,n);return{mortgagePayment:o,remainingMortgagePayments:r,mortgageProjection:c,returnOnInvestments:i,averageContribution:u,currentInvestments:s,averageExpenses:d,retirementReturns:.04,retirementTaxRate:.15,maxAverageExpenses:1e3*Math.ceil(2*d/1e3),maxAverageContribution:1e3*Math.ceil(2*u/1e3)}}),Kr=function(e){function t(e){var n;return Object(ie.a)(this,t),(n=Object(se.a)(this,Object(le.a)(t).call(this))).handleChange=function(e){n.setState(Object(b.a)({},e.target.name,parseFloat(e.target.value)))},n.handleSelectAdjusting=function(e){n.setState(function(t){return{adjustingName:t.adjustingName===e?null:e}})},n.handleClearSelection=function(){n.setState({adjustingName:null})},n.handleResetCalculation=function(e){var t=n.props,a=t.budget,r=t.investmentAccounts,o=t.mortgageAccounts;n.setState(ht()(e)(qr(a,r,o)))},n.state=Object(v.a)({},qr(e.budget,e.investmentAccounts,e.mortgageAccounts),{adjustingName:null}),n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){for(var e=this,t=this.state,n=t.mortgagePayment,o=t.remainingMortgagePayments,c=t.mortgageProjection,i=t.returnOnInvestments,u=t.averageContribution,s=t.currentInvestments,l=t.averageExpenses,d=t.retirementReturns,m=t.retirementTaxRate,g=t.maxAverageExpenses,p=t.maxAverageContribution,f=t.adjustingName,y=function(e){var t=e.numMonths,n=e.returnOnInvestments,a=e.averageContribution,r=e.currentInvestments,o=Math.pow(1+n,1/12)-1,c=r,i=[];do{i.push(c),c+=a+(c+.5*a)*o}while(i.length<t);return i}({numMonths:600,returnOnInvestments:i,averageContribution:u,currentInvestments:s}),b=Math.pow(1+d,1/12)-1,v=l/(b*(1-m)),E=0;E<y.length;){if(E<o){var M=Dt()(0,o-E).reduce(function(e,t){return e+n/Math.pow(1+b*(1-m),t)},0);if((y[E]-M)*b*(1-m)>l)break}else if(y[E]*b*(1-m)>l)break;E+=1}var O=function(e){var t=e.numMonths,n=e.returnOnInvestments,a=e.averageContribution,r=e.currentInvestments,o=e.monthsBeforeRetirement,c=e.monthlyExpenses,i=e.retirementReturns,u=e.retirementTaxRate,s=e.remainingMortgagePayments,l=e.mortgagePayment,d=Math.pow(1+n,1/12)-1,h=Math.pow(1+i,1/12)-1,m=r,g=[];do{g.push(m),g.length<o?m+=a+(m+.5*a)*d:(m+=m*h*(1-u)-c,g.length<s&&(m-=l))}while(g.length<t);return g}({numMonths:600,returnOnInvestments:i,averageContribution:u,currentInvestments:s,monthsBeforeRetirement:E,monthlyExpenses:l,retirementReturns:d,retirementTaxRate:m,remainingMortgagePayments:o,mortgagePayment:n}),x=!!n,j=E/12,C=S()([gt()(xr.a),Mr()(12)])(O),I=S()([gt()(xr.a),Mr()(12)])(c),k={averageContribution:{min:0,max:p,step:50},returnOnInvestments:{min:0,max:.2,step:.001},averageExpenses:{min:0,max:g,step:50},retirementReturns:{min:0,max:.2,step:.001},retirementTaxRate:{min:0,max:.5,step:.001}};return r.a.createElement(a.Fragment,null,r.a.createElement(_t,{title:"Projection"},r.a.createElement(Zt,{numbers:[{amount:-v,label:"needed for retirement",decimalsToRound:0},{amount:-j,label:"years to retirement",isMoney:!1,decimalsToRound:1}]}),r.a.createElement(Pr,{investmentsProjection:C,mortgageProjection:I,amountNeededToRetire:v,yearsUntilRetirement:j})),r.a.createElement(_t,{title:"Assumptions"},Ur.map(function(t){var n=t.label,a=t.name,o=t.formatter;return r.a.createElement(Hr,{key:a,label:n,name:a,value:e.state[a],formatter:o,isAdjusting:f===a,onSelect:e.handleSelectAdjusting,onReset:e.handleResetCalculation,onChange:e.handleChange})}),x&&r.a.createElement(a.Fragment,null,r.a.createElement(Vr,{label:"Mortgage payment",value:n,formatter:function(e){return"$".concat(e.toFixed(2))}}),r.a.createElement(Vr,{label:"Time remaining on mortgage",value:o,formatter:function(e){return"".concat((e/12).toFixed(1)," years")}}))),r.a.createElement(Nr,{name:f,label:h()([f,"label"])(Wr),onReset:this.handleResetCalculation,onChange:this.handleChange,onBlur:this.handleClearSelection,formatter:h()([f,"formatter"])(Wr),value:this.state[f],rangeOptions:k[f]}))}}]),t}(a.PureComponent),Hr=function(e){var t=e.label,n=e.value,a=e.formatter,o=e.name,c=e.onSelect,i=e.isAdjusting;return r.a.createElement(Vr,{label:t,value:n,formatter:a,onClick:function(){c(o)},highlightValue:i,isAdjustable:!0})},Vr=function(e){var t=e.label,n=e.value,a=e.onClick,o=e.highlightValue,c=e.isAdjustable,i=e.formatter,u=void 0===i?function(e){return e}:i;return r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"2px 0"}},t,":",r.a.createElement("div",{style:{display:"flex",alignItems:"center"},onClick:a},r.a.createElement("strong",{style:{backgroundColor:o?_e:null,padding:c&&"0 4px",borderRadius:2}},u(n)),c&&r.a.createElement(ot,{icon:"pencil",faded:!0,style:{marginLeft:4}})))},Jr=Kr;function $r(){var e=Object(fe.a)(["\n  margin: ",";\n  padding: ",";\n  background-color: #fff;\n  border: 1px solid #e5e5e5;\n  border-width: ",";\n  border-radius: 2px;\n"]);return $r=function(){return e},e}var Zr=ye.a.div($r(),function(e){return e.top?"0":"3px"},function(e){return e.noPadding?"0":e.top?"15px 23px":"15px 20px"},function(e){return e.top?"0 0 1px":"1px"}),Qr=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=e.target,a=t.name,r=t.checked,o=n.props,c=o.value;(0,o.onChange)(r?Object(v.a)({},c,Object(b.a)({},a,!0)):P()(a)(c))},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.accounts,a=t.value;return n.map(function(t){var n=t.id,o=t.name;return r.a.createElement($n,{key:n,checked:!!a[n],name:n,onChange:e.handleChange,label:o})})}}]),t}(a.Component);function Xr(){var e=Object(fe.a)(["\n  height: 20px;\n"]);return Xr=function(){return e},e}function eo(){var e=Object(fe.a)(["\n  display: flex;\n  justify-content: space-between;\n"]);return eo=function(){return e},e}var to=ye.a.div(eo()),no=ye.a.div(Xr()),ao=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={investmentModalOpen:!1,mortgageModalOpen:!1},n.handleClickEdit=function(e){"investment"===e&&n.setState({investmentModalOpen:!0}),"mortgage"===e&&n.setState({mortgageModalOpen:!0})},n.handleCloseInvestmentModal=function(){n.setState({investmentModalOpen:!1})},n.handleCloseMortgageModal=function(){n.setState({mortgageModalOpen:!1})},n.handleChangeInvestment=function(e){n.props.onUpdateAccounts({type:"investment",value:e})},n.handleChangeMortgage=function(e){n.props.onUpdateAccounts({type:"mortgage",value:e})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.budget,o=t.investmentAccounts,c=t.mortgageAccounts,i=this.state,u=i.investmentModalOpen,s=i.mortgageModalOpen,l=n.accounts.filter(function(e){return"otherAsset"===e.type&&!e.on_budget}),d=n.accounts.filter(function(e){return"otherLiability"===e.type&&!e.on_budget}),h=n.accounts.filter(function(e){var t=e.id;return o[t]}),m=n.accounts.filter(function(e){var t=e.id;return c[t]});return r.a.createElement(a.Fragment,null,r.a.createElement(Zr,null,r.a.createElement(to,null,r.a.createElement(Ce,null,"Investment Accounts"),r.a.createElement("span",{onClick:function(){e.handleClickEdit("investment")}},r.a.createElement(ot,{icon:"pencil"}))),h.length?h.map(function(e){var t=e.id,n=e.name;return r.a.createElement("div",{key:t},n)}):r.a.createElement(bn,null,"No accounts marked as investment"),r.a.createElement(Ie,{style:{marginTop:10}},"Transfers to investment accounts are not counted as spending since it's assumed it's for retirement or some other savings goal."),r.a.createElement(ln,{open:u,onClose:this.handleCloseInvestmentModal,title:"Investment Accounts"},r.a.createElement(Qr,{accounts:l,value:o,onChange:this.handleChangeInvestment})),r.a.createElement(no,null),r.a.createElement(to,null,r.a.createElement(Ce,null,"Mortgage Accounts"),r.a.createElement("span",{onClick:function(){e.handleClickEdit("mortgage")}},r.a.createElement(ot,{icon:"pencil"}))),m.length?m.map(function(e){var t=e.id,n=e.name;return r.a.createElement("div",{key:t},n)}):r.a.createElement(bn,null,"No accounts marked as mortgage"),r.a.createElement(Ie,{style:{marginTop:10}},"Mortgage accounts are used in the retirement calculator since it's a significant expense you won't have in your retirement presumably."),r.a.createElement(ln,{open:s,onClose:this.handleCloseMortgageModal,title:"Mortgage Account"},r.a.createElement(Qr,{accounts:d,value:c,onChange:this.handleChangeMortgage}))))}}]),t}(a.Component),ro=function(e,t){return e.replace(/:([a-zA-Z]*)/g,function(e,n){return t[n]})},oo={currentMonth:{path:"/budgets/:budgetId/current",title:"Current Month Spending",Component:Bn,props:function(e){return{budget:e.budget,currentMonth:e.currentMonth,investmentAccounts:e.investmentAccounts}}},currentMonthGroup:{path:"/budgets/:budgetId/current/:categoryGroupId",title:function(e,t){return t.categoryGroupsById[e.categoryGroupId].name},Component:Fn,props:function(e,t){return{budget:e.budget,categoryGroupId:t.categoryGroupId,currentMonth:e.currentMonth}},breadcrumbs:["currentMonth"]},currentMonthCategory:{path:"/budgets/:budgetId/current/:categoryGroupId/:categoryId",title:function(e,t){return t.categoriesById[e.categoryId].name},Component:Rn,props:function(e,t){return{budget:e.budget,categoryId:t.categoryId,categoryGroupId:t.categoryGroupId,currentMonth:e.currentMonth}},breadcrumbs:["currentMonth","currentMonthGroup"]},groups:{path:"/budgets/:budgetId/groups",title:"Spending Trends",Component:ea,props:function(e){return{budget:e.budget}}},group:{path:"/budgets/:budgetId/groups/:categoryGroupId",title:function(e,t){return t.categoryGroupsById[e.categoryGroupId].name},Component:aa,props:function(e,t){return{budget:e.budget,categoryGroup:e.budget.categoryGroupsById[t.categoryGroupId]}},breadcrumbs:["groups"]},category:{path:"/budgets/:budgetId/groups/:categoryGroupId/categories/:categoryId",title:function(e,t){return t.categoriesById[e.categoryId].name},Component:ra,props:function(e,t){return{budget:e.budget,category:e.budget.categoriesById[t.categoryId]}},breadcrumbs:["groups","group"]},categoryPayee:{path:"/budgets/:budgetId/groups/:categoryGroupId/categories/:categoryId/payees/:payeeId",title:function(e,t){return t.payeesById[e.payeeId].name},Component:oa,props:function(e,t){return{budget:e.budget,category:e.budget.categoriesById[t.categoryId],payee:e.budget.payeesById[t.payeeId]}},breadcrumbs:["groups","group","category"]},income:{path:"/budgets/:budgetId/income",title:"Income Trends",Component:ca,props:function(e){return{budget:e.budget}}},incomeVsExpenses:{path:"/budgets/:budgetId/income-vs-expenses",title:"Income vs Expenses",Component:Ba,props:function(e){return{budget:e.budget,investmentAccounts:e.investmentAccounts,showing:e.settings.incomeVsExpensesShowing}}},netWorth:{path:"/budgets/:budgetId/net-worth",title:"Net Worth",Component:pr,props:function(e){return{budget:e.budget,investmentAccounts:e.investmentAccounts,mortgageAccounts:e.mortgageAccounts}}},investments:{path:"/budgets/:budgetId/investments",title:"Investments",Component:vr,props:function(e){return{budget:e.budget,investmentAccounts:e.investmentAccounts}}},projections:{path:"/budgets/:budgetId/projections",title:"Retirement Calculator",Component:Jr,props:function(e){return{budget:e.budget,investmentAccounts:e.investmentAccounts,mortgageAccounts:e.mortgageAccounts}}},settings:{path:"/budgets/:budgetId/settings",title:"Budget Settings",Component:ao,props:function(e){return{budget:e.budget,investmentAccounts:e.investmentAccounts,mortgageAccounts:e.mortgageAccounts,onUpdateAccounts:e.onUpdateAccounts}}}};function co(){var e=Object(fe.a)(["\n  color: inherit;\n  display: flex;\n  align-items: center;\n  height: 60px;\n  padding: 0 20px;\n  border-top: 1px solid #eee;\n  background-color: ",";\n  &:last-of-type {\n    border-bottom: 1px solid #eee;\n  }\n"]);return co=function(){return e},e}function io(){var e=Object(fe.a)(["\n  width: ","px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]);return io=function(){return e},e}function uo(){var e=Object(fe.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: stretch;\n  height: 60px;\n"]);return uo=function(){return e},e}var so=ye.a.div(uo()),lo=ye.a.div(io(),60),ho=Object(ye.a)(ct.a)(co(),function(e){return e.active&&_e}),mo=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budgetId,n=e.hasMultipleBudgets,o=e.location,c=e.onCloseSidebar;return r.a.createElement(a.Fragment,null,r.a.createElement(go,{onCloseSidebar:c,budgetId:t}),["currentMonth","groups","income","incomeVsExpenses","netWorth","investments","projections"].map(function(e){var n=oo[e],a=n.path,i=n.title;return r.a.createElement(po,{key:a,to:ro(a,{budgetId:t}),active:Object(ut.a)(o,{path:a}),onClick:c},i)}),n&&r.a.createElement(po,{to:"/"},"Switch Budgets"))}}]),t}(a.PureComponent),go=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onCloseSidebar,n=e.budgetId;return r.a.createElement(so,null,r.a.createElement(lo,{onClick:t},r.a.createElement(ot,{icon:"times"})),r.a.createElement(it.a,{to:ro(oo.settings.path,{budgetId:n}),style:{display:"flex",color:"inherit"},onClick:t},r.a.createElement(lo,null,r.a.createElement(ot,{icon:"cog"}))))}}]),t}(a.PureComponent),po=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){return r.a.createElement(ho,this.props)}}]),t}(a.PureComponent),fo=mo,yo=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1},n.handleSetOpen=function(e){n.setState({open:e})},n.handleTriggerClick=function(){n.setState({open:!0})},n.handleCloseSidebar=function(){n.setState({open:!1})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this.props,t=e.budgetId,n=e.children,a=e.hasMultipleBudgets,o=e.location,c=this.state.open;return r.a.createElement(ze.a,{sidebar:r.a.createElement(fo,{budgetId:t,hasMultipleBudgets:a,location:o,onCloseSidebar:this.handleCloseSidebar}),open:c,onSetOpen:this.handleSetOpen,styles:{sidebar:{backgroundColor:"#fff",width:280,pointerEvents:!c&&"none"}}},n({sidebarTrigger:r.a.createElement(bo,{onClick:this.handleTriggerClick})}))}}]),t}(a.Component),bo=function(e){var t=e.onClick;return r.a.createElement("div",{onClick:t,style:{alignSelf:"stretch",display:"flex",alignItems:"center",justifyContent:"center",width:60}},r.a.createElement(ot,{icon:"bars"}))},vo=yo,Eo=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).toBeScrolled=null,n.raf=null,n.scrollPositions={},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"getSnapshotBeforeUpdate",value:function(){return{scrollTop:this.toBeScrolled.scrollTop}}},{key:"componentDidUpdate",value:function(e,t,n){var a=this,r=this.props,o=r.action,c=r.location;c!==e.location&&("POP"===o&&(this.scrollPositions[e.location]=n.scrollTop,this.raf=requestAnimationFrame(function(){a.toBeScrolled.scrollTop=a.scrollPositions[c]||0})),"PUSH"===o&&(this.scrollPositions[e.location]=n.scrollTop,this.raf=requestAnimationFrame(function(){a.toBeScrolled.scrollTop=0})),"REPLACE"===o&&(this.raf=requestAnimationFrame(function(){a.toBeScrolled.scrollTop=0})))}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.raf)}},{key:"render",value:function(){var e=this;return this.props.children({ref:function(t){e.toBeScrolled=t}})}}]),t}(a.Component);function Mo(){var e=Object(fe.a)(["\n  flex-grow: 1;\n  overflow-y: auto;\n"]);return Mo=function(){return e},e}function Oo(){var e=Object(fe.a)(["\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  height: 60px;\n  padding-left: 0;\n  padding-right: 20px;\n  background-color: #fff;\n  border-bottom: 1px solid #ccc;\n  white-space: pre;\n  user-select: none;\n"]);return Oo=function(){return e},e}function xo(){var e=Object(fe.a)(["\n  height: 100%;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n"]);return xo=function(){return e},e}var jo=ye.a.div(xo()),Co=ye.a.div(Oo()),So=ye.a.div(Mo()),Io=function(e){var t=e.content,n=e.authorized,a=e.budgetId,o=e.budgetLoaded,c=e.hasMultipleBudgets,i=e.historyAction,u=e.location,s=e.title,l=e.actions,d=e.breadcrumbs,h=e.onAuthorize,m=e.onRequestBudget;return r.a.createElement(Ae,{budgetId:a,budgetLoaded:o,onRequestBudget:m},r.a.createElement(vo,{budgetId:a,location:u,hasMultipleBudgets:c},function(e){var a=e.sidebarTrigger;return r.a.createElement(jo,null,r.a.createElement(Co,null,a,r.a.createElement("div",{style:{flexGrow:1}},d,r.a.createElement(xe,{style:{lineHeight:1}},s)),l),r.a.createElement(Eo,{action:i,location:u},function(e){var n=e.ref;return r.a.createElement(So,{ref:n},t)}),!n&&r.a.createElement("div",{style:{padding:"15px 20px",backgroundColor:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0,borderTop:"1px solid #ccc"}},"Your authorization expired.",r.a.createElement(De,{onClick:h},"Reauthorize")))}))},ko=function(e){var t=e.budget;return t&&r.a.createElement(he.a,null,Za()(oo).map(function(e){var n=e.path,a=e.title;return r.a.createElement(me.a,{key:n,path:n,exact:!0,render:function(e){return"function"===typeof a?a(e.match.params,t):a}})}),r.a.createElement(me.a,{render:function(){return"Page Not Found"}}))},Ao=Za()(oo).filter(function(e){return!!e.breadcrumbs}).map(function(e){return{path:e.path,breadcrumbs:e.breadcrumbs.map(function(e){return{title:oo[e].title,path:oo[e].path}})}}),wo=function(e){var t=e.budget;return t&&r.a.createElement(he.a,null,Ao.map(function(e){var n=e.path,o=e.breadcrumbs;return r.a.createElement(me.a,{key:n,path:n,exact:!0,render:function(e){return r.a.createElement(Ie,{style:{lineHeight:1,whiteSpace:"normal"}},o.map(function(n,c){var i=n.title,u=n.path;return r.a.createElement(a.Fragment,{key:u},r.a.createElement(it.a,{to:ro(u,e.match.params),style:{paddingBottom:8,display:"inline-block"}},"function"===typeof i?i(e.match.params,t):i),c!==o.length-1&&r.a.createElement(ot,{icon:"chevron-right",style:{padding:"0 5px",fontSize:8}}))}))}})}))},Bo=function(e){var t=e.settings,n=e.onChangeSetting;return r.a.createElement(he.a,null,r.a.createElement(me.a,{path:oo.currentMonth.path,exact:!0,render:function(e){var t=e.match;return r.a.createElement(Se,null,r.a.createElement(it.a,{to:ro(oo.groups.path,t.params)},"Past Months"))}}),r.a.createElement(me.a,{path:oo.currentMonthGroup.path,exact:!0,render:function(e){var t=e.match;return r.a.createElement(Se,null,r.a.createElement(it.a,{to:ro(oo.group.path,t.params)},"Past Months"))}}),r.a.createElement(me.a,{path:oo.currentMonthCategory.path,exact:!0,render:function(e){var t=e.match;return r.a.createElement(Se,null,r.a.createElement(it.a,{to:ro(oo.category.path,t.params)},"Past Months"))}}),r.a.createElement(me.a,{path:oo.groups.path,exact:!0,render:function(e){var t=e.match;return r.a.createElement(Se,null,r.a.createElement(it.a,{to:ro(oo.currentMonth.path,t.params)},"Current Month"))}}),r.a.createElement(me.a,{path:oo.group.path,exact:!0,render:function(e){var t=e.match;return r.a.createElement(Se,null,r.a.createElement(it.a,{to:ro(oo.currentMonthGroup.path,t.params)},"Current Month"))}}),r.a.createElement(me.a,{path:oo.category.path,exact:!0,render:function(e){var t=e.match;return r.a.createElement(Se,null,r.a.createElement(it.a,{to:ro(oo.currentMonthCategory.path,t.params)},"Current Month"))}}),r.a.createElement(me.a,{path:oo.incomeVsExpenses.path,exact:!0,render:function(){return r.a.createElement(Se,{onClick:function(){n({setting:"incomeVsExpensesShowing",value:"average"===t.incomeVsExpensesShowing?"total":"average"})},style:{userSelect:"none"}},t.incomeVsExpensesShowing)}}))},_o={selectedMonth:null,selectedGroupId:null,selectedCategoryId:null,selectedPayeeId:null},To=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state=_o,n.cachedStates={},n.handleSelectMonth=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedMonth:t.selectedMonth===e?null:e})})},n.handleSelectGroup=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedGroupId:t.selectedGroupId===e?null:e})})},n.handleSelectCategory=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedCategoryId:t.selectedCategoryId===e?null:e})})},n.handleSelectPayee=function(e){n.setState(function(t){return Object(v.a)({},t,{selectedPayeeId:t.selectedPayeeId===e?null:e})})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"getSnapshotBeforeUpdate",value:function(){return this.state}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props,r=a.location,o=a.action;r!==e.location&&("POP"===o&&(this.cachedStates[e.location]=n,this.setState(this.cachedStates[r])),"PUSH"===o&&(this.cachedStates[e.location]=n,this.setState(_o)),"REPLACE"===o&&this.setState(_o))}},{key:"render",value:function(){return this.props.children(Object(v.a)({},this.state,{onSelectMonth:this.handleSelectMonth,onSelectGroup:this.handleSelectGroup,onSelectCategory:this.handleSelectCategory,onSelectPayee:this.handleSelectPayee,onSetExclusion:this.handleSetExclusion}))}}]),t}(a.Component),Po=q(function(e,t,n,a){var r=Et(e),o=l()().format("YYYY-MM");return e.transactions.filter(K([ft(e),bt(t),function(e){return n&&vt(e)===r},function(e){return a&&vt(e)===o}]))}),Fo=q(function(e,t,n,a){return Po(e,t,n,a).filter(function(t){return!yt(e)(t)})}),Ro=q(function(e,t,n,a){return Po(e,t,n,a).filter(function(t){return yt(e)(t)}).map(function(e){return Object(v.a)({},e,{amount:-e.amount})})}),Go=oo.groups.path,Lo=z(function(e){return e.path.startsWith(Go)?"trendPages":"otherPages"})(Za()(oo)),Do=function(e){return e.budget&&r.a.createElement(he.a,null,r.a.createElement(me.a,{path:Go,render:function(t){var n=t.match;return r.a.createElement(fr,{budget:e.budget},function(t){var a=t.excludeFirstMonth,o=t.excludeLastMonth,c=t.months,i=t.onSetExclusion,u=Fo(e.budget,e.investmentAccounts,a,o);return r.a.createElement(To,{key:n.params.categoryGroupId,action:e.historyAction,location:e.location},function(t){var n=t.selectedMonth,s=t.selectedGroupId,l=t.selectedCategoryId,d=t.selectedPayeeId,h=t.onSelectMonth,m=t.onSelectGroup,g=t.onSelectCategory,p=t.onSelectPayee;return r.a.createElement(he.a,null,Lo.trendPages.map(function(t){var f=t.path,y=t.props,b=t.Component;return r.a.createElement(me.a,{key:f,path:f,exact:!0,render:function(t){var f=t.match;return r.a.createElement(b,Object.assign({},y(e,f.params),{excludeFirstMonth:a,excludeLastMonth:o,months:c,selectedMonth:n,selectedGroupId:s,selectedCategoryId:l,selectedPayeeId:d,transactions:u,onSelectMonth:h,onSelectGroup:m,onSelectCategory:g,onSelectPayee:p,onSetExclusion:i}))}})}))})})}}),r.a.createElement(me.a,{path:oo.income.path,exact:!0,render:function(t){var n=t.match,a=oo.income.Component;return r.a.createElement(fr,{budget:e.budget},function(t){var o=t.excludeFirstMonth,c=t.excludeLastMonth,i=t.months,u=t.onSetExclusion,s=Ro(e.budget,e.investmentAccounts,o,c);return r.a.createElement(a,Object.assign({},oo.income.props(e,n.params),{excludeFirstMonth:o,excludeLastMonth:c,months:i,transactions:s,onSetExclusion:u}))})}}),r.a.createElement(me.a,{path:oo.incomeVsExpenses.path,exact:!0,render:function(t){var n=t.match,a=oo.incomeVsExpenses.Component;return r.a.createElement(fr,{budget:e.budget},function(t){var o=t.excludeFirstMonth,c=t.excludeLastMonth,i=t.onSetExclusion,u=Po(e.budget,e.investmentAccounts,o,c);return r.a.createElement(a,Object.assign({},oo.incomeVsExpenses.props(e,n.params),{excludeFirstMonth:o,excludeLastMonth:c,transactions:u,onSetExclusion:i}))})}}),Lo.otherPages.map(function(t){var n=t.path,a=t.props,o=t.Component;return r.a.createElement(me.a,{key:n,path:n,exact:!0,render:function(t){var n=t.match;return r.a.createElement(o,a(e,n.params))}})}),r.a.createElement(me.a,{render:function(){return r.a.createElement("div",{style:{padding:20}},r.a.createElement(it.a,{to:ro(oo.currentMonth.path,{budgetId:e.budget.id})},"Return to ",oo.currentMonth.title))}}))},Yo=function(e){var t=e.onAuthorize;return r.a.createElement(Zr,null,r.a.createElement(xe,null,"Budget Reports"),r.a.createElement("div",{style:{marginBottom:10}},"Get various insights from your YNAB account."),r.a.createElement(De,{onClick:t},"Authorize YNAB"),r.a.createElement(Ce,{style:{marginTop:30}},"Privacy Policy"),r.a.createElement(Se,null,"This website does not store any information from you or your YNAB account on it's server. All data retrieved from the YNAB API is stored only in your browser's local storage and is never transmitted to any other location or third-party."))};function zo(){var e=Object(fe.a)(["\n  padding: 10px 20px;\n"]);return zo=function(){return e},e}var No=ye.a.div(zo()),Uo=function(e){var t=e.message;return r.a.createElement(No,null,r.a.createElement("h3",null,t),r.a.createElement("div",null,r.a.createElement(it.a,{to:"/"},"Home")))},Wo=function(){return r.a.createElement(Uo,{message:"Page not found"})},qo=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={hasError:!1},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"componentDidCatch",value:function(e){Rollbar.error(e),this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(Uo,{message:this.props.message}):this.props.children}}]),t}(a.Component);qo.defaultProps={message:"Something went wrong"};var Ko,Ho=qo,Vo=function(e){function t(){return Object(ie.a)(this,t),Object(se.a)(this,Object(le.a)(t).apply(this,arguments))}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"componentDidMount",value:function(){this.props.budgetsLoaded||this.props.onRequestBudgets()}},{key:"render",value:function(){var e=this.props,t=e.budgets;return e.budgetsLoaded?r.a.createElement(Zr,null,r.a.createElement(Ce,null,"Select a budget:"),t.map(function(e){var t=e.id,n=e.name;return r.a.createElement("div",{key:t},r.a.createElement(it.a,{to:ro(oo.currentMonth.path,{budgetId:t})},n))})):r.a.createElement(ke,null)}}]),t}(a.Component),Jo=function(e){function t(){var e,n;Object(ie.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(se.a)(this,(e=Object(le.a)(t)).call.apply(e,[this].concat(r)))).state={authorized:!0,budgetsLoaded:!1,budgetIds:[],budgets:{},budgetDetails:{},currentMonth:l()().format("YYYY-MM"),settings:{payeesSort:"amount",incomeVsExpensesShowing:"average"}},n.handleRequestBudgets=function(e){ae().then(function(t){var a=t.budgets;n.setState({budgetsLoaded:!0,budgetIds:a.map(function(e){return e.id}),budgets:pe()("id")(a)},e)})},n.handleRequestBudget=function(e){oe(e).then(function(t){var a=t.budget,r=t.authorized;n.setState(function(t){return Object(v.a)({},t,{authorized:r,budgetDetails:Object(v.a)({},t.budgetDetails,Object(b.a)({},e,a))})})})},n.handleAuthorize=function(){ce(),window.location.replace(te)},n.handleChangeSetting=function(e){var t=e.setting,a=e.value;n.setState(function(e){return Object(v.a)({},e,{settings:Object(v.a)({},e.settings,Object(b.a)({},t,a))})})},n}return Object(de.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this,t=this.props.hasToken,n=this.state,a=n.authorized,o=n.budgetsLoaded,c=n.budgetIds,i=n.budgets,u=n.budgetDetails,s=n.currentMonth,l=n.settings;return t?r.a.createElement(Ho,null,r.a.createElement(he.a,null,r.a.createElement(me.a,{path:"/",exact:!0,render:function(){return r.a.createElement(Vo,{budgets:c.map(function(e){return i[e]}),budgetsLoaded:o,onRequestBudgets:e.handleRequestBudgets})}}),r.a.createElement(me.a,{path:"/budgets/:budgetId",render:function(t){var n=t.match.params.budgetId,o=u[n];return r.a.createElement(Vt.Provider,{value:h()("currencyFormat")(o)},r.a.createElement(Io,{authorized:a,budgetId:n,budgetLoaded:!!o,hasMultipleBudgets:c.length>1,historyAction:t.history.action,location:t.location.pathname,onAuthorize:e.handleAuthorize,onRequestBudget:e.handleRequestBudget,title:r.a.createElement(ko,{budget:o}),breadcrumbs:r.a.createElement(wo,{budget:o}),actions:r.a.createElement(Bo,{settings:l,onChangeSetting:e.handleChangeSetting}),content:r.a.createElement(Do,{budget:o,currentMonth:s,investmentAccounts:x("investmentAccounts",n),mortgageAccounts:x("mortgageAccounts",n),settings:l,historyAction:t.history.action,location:t.location.pathname,onChangeSetting:e.handleChangeSetting,onUpdateAccounts:function(t){var a=t.type,r=t.value;"investment"===a&&j("investmentAccounts",n,r),"mortgage"===a&&j("mortgageAccounts",n,r),e.forceUpdate()}})}))}}),r.a.createElement(me.a,{component:Wo}))):r.a.createElement(Yo,{onAuthorize:this.handleAuthorize})}}]),t}(a.Component),$o=function(){if("/"===window.location.hash[1])return localStorage.getItem("ynab_access_token");var e=window.location.hash.substring(1).replace(/&/g,'","').replace(/=/g,'":"');if(!e)return localStorage.getItem("ynab_access_token");var t=h()("access_token")(JSON.parse('{"'+e+'"}',function(e,t){return""===e?t:decodeURIComponent(t)}));return localStorage.setItem("ynab_access_token",t),window.location.hash=localStorage.getItem("budget-reports-last-location")||"",localStorage.removeItem("budget-reports-last-location"),t}();$o&&(Ko=$o,ne=new u.a(Ko)),c.a.render(r.a.createElement(i.a,null,r.a.createElement(Jo,{hasToken:!!$o})),document.getElementById("root"))}},[[232,2,1]]]);
//# sourceMappingURL=main.a05cfd63.chunk.js.map